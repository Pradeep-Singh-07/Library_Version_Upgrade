{"version":3,"sources":["webpack://watchRTC/webpack/universalModuleDefinition","webpack://watchRTC/./src/index.ts","webpack://watchRTC/./src/sdk.ts","webpack://watchRTC/./src/stats.ts","webpack://watchRTC/./src/types.ts","webpack://watchRTC/./src/utils.ts","webpack://watchRTC/./src/version.ts","webpack://watchRTC/./src/watchrtchttp.ts","webpack://watchRTC/./src/watchrtcsocket.ts","webpack://watchRTC/./src/detect-gpu.js","webpack://watchRTC/./src/gpu-benchmarks|sync|/^/.*$","webpack://watchRTC/./src/lz-string.js","webpack://watchRTC/webpack/bootstrap","webpack://watchRTC/webpack/startup","webpack://watchRTC/webpack/runtime/hasOwnProperty shorthand"],"names":["root","factory","exports","module","define","amd","self","sdk_1","watchrtcConfig","services","initSDK","setConfig","_rtcTags","rating","comment","setUserRating","keys","addKeys","disableDataCollection","enableDataCollection","event","addEvent","id","name","mapStream","mapTrack","connect","disconnect","listener","registerOnStatsListener","nailUpCallEnd","persistentEnd","roomId","peerId","persistentStart","registerStateListener","default","init","addTags","addStatsListener","addStateListener","__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArray","to","from","pack","ar","l","Array","slice","concat","defineProperty","trace","getStatsInterval","hardwareInfo","currentAudioOutputId","reconnectTimerId","getStatsCallback","watchrtcsocket_1","watchrtchttp_1","utils_1","version_1","isFirefox","window","mozRTCPeerConnection","openChannels","RTCPeerConnection","navigator","webkitGetUserMedia","peerconnectioncounter","connectionData","watchrtcIdentifiers","rtcRoomId","undefined","rtcPeerId","projectId","http","socket","lastConnectionOpen","tryingToConnectSocket","authFailed","isManualConnect","isManualDisconnect","stateListener","debugLog","bind","debug","mappedTrack","maybeOpenWebsocketConnection","_a","_b","_c","forceRecreate","_d","reconnecting","_e","pcId","JSON","stringify","connection","readyState","WebSocket","OPEN","isRoomIdOrPeerIdChanged","close","connectionCount","countOfValidConnections","canConnect","validateConfig","forEach","k","useToken","rtcToken","wsConnectionData","getConnectionData","rtcApiKey","proxyUrl","Date","now","startStatsCollection","wsOpeningTimestamp","url","key","onData","data","_i","entries","allowBrowserLogCollection","Boolean","collectConsoleLogEnabled","console","override","collectConsoleLogLevel","setConsoleLevel","restoreOriginalConsoleMethods","buffer","filter","info","logPrefix","connectionId","sdkVersion","watchRTCSessionId","interval","collectionInterval","oldInterval","resetConnectionState","onError","type","onOpen","connectionStatus","clearInterval","delta","onClose","closeEvent","code","reason","wasClean","setInterval","stats","pcInfo","peer","streams","connections","values","pc","signalingState","getStats","__reject","id_1","pc_1","prev_1","prev","res","logGetStats","report","map2obj","base","parse","applyPatchForRTT","deltaCompression","timestamp","exposeApplicationStatsForPC","watchrtc","prefixesToWrap","watchRTCInitialized","toString","indexOf","warn","generateID","setTimeout","getHardwareStartTime","getHardwareInfo","hwInfo","getHardwareTime","catch","err","error","message","urlParams","URLSearchParams","location","search","has","get","socketService","httpService","wsUrl","prefix","origPeerConnection","peerconnection","config","constraints","__rtcStatsId","validConnection","nullConfig","iceServers","server","credential","browserType","addEventListener","candidate","stream","getTracks","map","kind","track","muted","onended","onmute","onunmute","iceConnectionState","iceGatheringState","connectionState","channel","HTMLMediaElement","nativeMethod_1","setSinkId","selectedDeviceId","mediaDevices","enumerateDevices","devices","currentDevice","find","deviceId","RTCRtpTransceiver","origRTCRtpTransceiver","nativeMethod_2","setCodecPreferences","__pcId","RTCRtpSender","nativeMethod_3","origRTCRtpSender","setParameters","nativeMethod_4","replaceTrack","method","nativeMethod","_this_1","join","trackOrKind","transceiver","sender","streamInfo","transceivers","getTransceivers","opts","rtcStatsId","args","description","_this","needToHandleSDPInSuccessCallback","sdp","parameterless","localDescription","generateCertificate","origGetUserMedia","cb","eb","dumpStream","errorData","httpReportError","getUserMedia","origGetUserMedia_1","getDisplayMedia","origGetDisplayMedia_1","level","newWatchrtcConfig","ratingComment","validateRating","opened","options","promiseFuncs","httpTrace","wasConnected","validateEvent","log","httpConnectionData","apiKey","getStreamsFromStats","getTransportFromStats","reports","reportKeys","keyPairs","reportKey","nominated","localCandidateId_1","localCandidateId","remoteCandidateId_1","remoteCandidateId","localCandidateKey","remoteCandidateKey","localCandidate","remoteCandidate","candidateType","transport","relayProtocol","address","port","previous","current","currentReportsKeys","streamKey","currentReport","previousReport","direction","currentRemoteReport","remoteId","previousRemoteReport","deltaSeconds","frameWidth","frameHeight","framerate","framesPerSecond","jitter","mappedName","trackIdentifier","bytesReceived","packetsReceived","packetsLost","packetsLoss","bitrate","roundTripTime","bytesSent","packetsSent","fractionLost","mediaSourceKey","mediaSourceId","outboundTrackIdentifier","mangleChromeStats","GPU","stats_1","getDebugStatus","object","logArgs","oldStats","newStats","getTime","isArray","response","standardReport","standardStats","names","stat","m","o","tracks","enabled","proxyURL","localUrl","staging1Url","staging2Url","productionUrl","production1Url","includes","replace","splitted","split","changed","old","new","parameters","number_format","num","Math","round","toFixed","loadBenchmarks","gpuInfo","memory","fileName","shift","stack","getGPUTier","cores_count","hardwareConcurrency","performance","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","patchConsoleConfig","originalMethodPrefix","methodsToPatch","patchConsoleMethod","methodName","originalMethod","currentMethodIndex","configMethodIndex","shouldTraceMethod","text","stringifyArgs","currentIndex","previousIndex","mappedTradk","item","replacerFunc","visited","WeakSet","_key","add","hasOldStats","statsHaveRTTMeasurements","roundTripTimeMeasurements","NaN","random","substring","WatchRTCHttp","_instance","fetch","mode","cache","credentials","headers","LZString","WatchRTCSocket","sendInterval","dataCollection","sendPromises","lines","compressedMessage","compressToEncodedURIComponent","logFunc","_original_log","send","onopen","onclose","onmessage","onerror","toggleDebug","r","setPrototypeOf","__proto__","a","u","c","throw","return","toLowerCase","userAgent","platform","maxTouchPoints","test","MSStream","isIpad","isMobile","isSafari12","createShader","createProgram","shaderSource","compileShader","attachShader","linkProgram","detachShader","deleteShader","useProgram","createBuffer","bindBuffer","bufferData","Float32Array","getAttribLocation","vertexAttribPointer","enableVertexAttribArray","clearColor","clear","viewport","drawArrays","Uint8Array","readPixels","deleteProgram","deleteBuffer","d","charCodeAt","h","constructor","String","create","Error","mobileTiers","desktopTiers","b","glContext","w","failIfMajorPerformanceCaveat","x","benchmarksURL","A","S","C","E","L","M","j","B","O","T","U","I","D","R","G","N","K","W","tier","screenSize","screen","json","parseInt","renderer","match","sort","Number","MAX_VALUE","devicePixelRatio","width","height","abs","device","fps","gpu","alpha","antialias","depth","powerPreference","stencil","document","createElement","getContext","getExtension","getParameter","UNMASKED_RENDERER_WEBGL","all","webpackContext","req","webpackContextResolve","__webpack_require__","charAt","fromCharCode","compressToBase64","_compress","decompressFromBase64","_decompress","compressToUTF16","decompressFromUTF16","compressToUint8Array","compress","decompressFromUint8Array","decompress","decompressFromEncodedURIComponent","pow","val","position","index","__webpack_module_cache__","moduleId","__webpack_modules__","obj","prop"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"watchRTC\"] = factory();\n\telse\n\t\troot[\"watchRTC\"] = factory();\n})(self, function() {\nreturn ","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.addStateListener = exports.persistentStart = exports.persistentEnd = exports.addStatsListener = exports.disconnect = exports.connect = exports.mapTrack = exports.mapStream = exports.addEvent = exports.enableDataCollection = exports.disableDataCollection = exports.addKeys = exports.setUserRating = exports.addTags = exports.setConfig = exports.init = void 0;\r\nrequire(\"./types\");\r\nvar sdk_1 = require(\"./sdk\");\r\n/**\r\n * Initialize SDK. Can be called multiple times but it will be initialized only at the first time.\r\n * Use 'setConfig' function after if you don't have rtcRoomId and rtcPeerId yet.\r\n * @param watchrtc\r\n * @param prefixesToWrap\r\n * @param services\r\n */\r\nvar init = function (watchrtcConfig, services) {\r\n    (0, sdk_1.initSDK)((watchrtcConfig || {}), [\"\"], services);\r\n};\r\nexports.init = init;\r\n/**\r\n * You also can use watchRTC.setConfig function to set watchRTC configuration after calling init()\r\n * and before the creation of RTCPeerConnection objects\r\n */\r\nvar setConfig = function (watchrtcConfig) {\r\n    (0, sdk_1.setConfig)(watchrtcConfig);\r\n};\r\nexports.setConfig = setConfig;\r\n/**\r\n * @deprecated Tags no longer supported. Use addKeys instead\r\n * Add tags for peer session\r\n * @param rtcTags[]\r\n */\r\nvar addTags = function (\r\n/** [\"tag1\", \"tag2\", \"tag3\"] */\r\n_rtcTags) { };\r\nexports.addTags = addTags;\r\n/**\r\n * Set user rating and/or comment for peer session\r\n * @param rating number from 1 to 5\r\n * @param comment string\r\n */\r\nvar setUserRating = function (\r\n/** 1 | 2 | 3 | 4 | 5 */\r\nrating, comment) {\r\n    (0, sdk_1.setUserRating)(rating, comment);\r\n};\r\nexports.setUserRating = setUserRating;\r\n/**\r\n * Add keys for peer session\r\n * @param keys\r\n */\r\nvar addKeys = function (\r\n/** { \"key1\": \"value1\", \"key2\": [\"value2_1\", \"value2_2\"]} */\r\nkeys) {\r\n    (0, sdk_1.addKeys)(keys);\r\n};\r\nexports.addKeys = addKeys;\r\n/**\r\n * Disables data collection\r\n */\r\nvar disableDataCollection = function () {\r\n    (0, sdk_1.disableDataCollection)();\r\n};\r\nexports.disableDataCollection = disableDataCollection;\r\n/**\r\n * Enables data collection\r\n */\r\nvar enableDataCollection = function () {\r\n    (0, sdk_1.enableDataCollection)();\r\n};\r\nexports.enableDataCollection = enableDataCollection;\r\nvar addEvent = function (event) {\r\n    (0, sdk_1.addEvent)(event);\r\n};\r\nexports.addEvent = addEvent;\r\n/**\r\n * Map an incoming stream with a human-readable name\r\n * @param id The identifier of the stream (streamIdentifier attribute)\r\n * @param name The human-readable name\r\n * @deprecated\r\n */\r\nvar mapStream = function (id, name) {\r\n    (0, sdk_1.mapStream)(id, name);\r\n};\r\nexports.mapStream = mapStream;\r\n/**\r\n * Map an incoming track with a human-readable name\r\n * @param id The identifier of the track (trackIdentifier attribute)\r\n * @param name The human-readable name\r\n */\r\nvar mapTrack = function (id, name) {\r\n    (0, sdk_1.mapTrack)(id, name);\r\n};\r\nexports.mapTrack = mapTrack;\r\nvar connect = function () {\r\n    (0, sdk_1.connect)();\r\n};\r\nexports.connect = connect;\r\nvar disconnect = function () {\r\n    (0, sdk_1.disconnect)();\r\n};\r\nexports.disconnect = disconnect;\r\nvar addStatsListener = function (listener) {\r\n    (0, sdk_1.registerOnStatsListener)(listener);\r\n};\r\nexports.addStatsListener = addStatsListener;\r\nvar persistentEnd = function (nailUpCallEnd) {\r\n    (0, sdk_1.persistentEnd)(nailUpCallEnd);\r\n};\r\nexports.persistentEnd = persistentEnd;\r\nvar persistentStart = function (roomId, peerId) {\r\n    (0, sdk_1.persistentStart)(roomId, peerId);\r\n};\r\nexports.persistentStart = persistentStart;\r\nvar addStateListener = function (listener) {\r\n    (0, sdk_1.registerStateListener)(listener);\r\n};\r\nexports.addStateListener = addStateListener;\r\nexports.default = {\r\n    /**\r\n     * Initialize SDK. Can be called multiple times but it will be initialized only at the first time.\r\n     * Use 'setConfig' function after if you don't have rtcRoomId and rtcPeerId yet.\r\n     * @param watchrtc\r\n     * @param prefixesToWrap\r\n     */\r\n    init: exports.init,\r\n    /**\r\n     * @deprecated Tags no longer supported. Use addKeys instead\r\n     * Add tags for peer session\r\n     * @param rtcTags[]\r\n     */\r\n    addTags: exports.addTags,\r\n    /**\r\n     * Set user rating and/or comment for peer session\r\n     * @param rating number from 1 to 5\r\n     * @param comment string\r\n     */\r\n    setUserRating: exports.setUserRating,\r\n    /**\r\n     * Add keys for peer session\r\n     * @param keys\r\n     */\r\n    addKeys: exports.addKeys,\r\n    /**\r\n     * You also can use watchRTC.setConfig function to set watchRTC configuration after calling init()\r\n     * and before the creation of RTCPeerConnection objects\r\n     */\r\n    setConfig: exports.setConfig,\r\n    /**\r\n     * Disables data collection\r\n     */\r\n    disableDataCollection: exports.disableDataCollection,\r\n    /**\r\n     * Enables data collection\r\n     */\r\n    enableDataCollection: exports.enableDataCollection,\r\n    addEvent: exports.addEvent,\r\n    /**\r\n     * Map an incoming stream with a human-readable name\r\n     * @param id The identifier of the stream (streamIdentifier attribute)\r\n     * @param name The human-readable name\r\n     * @deprecated\r\n     */\r\n    mapStream: exports.mapStream,\r\n    /**\r\n     * Map an incoming track with a human-readable name\r\n     * @param id The identifier of the track (trackIdentifier attribute)\r\n     * @param name The human-readable name\r\n     */\r\n    mapTrack: exports.mapTrack,\r\n    connect: exports.connect,\r\n    disconnect: exports.disconnect,\r\n    addStatsListener: exports.addStatsListener,\r\n    persistentEnd: exports.persistentEnd,\r\n    persistentStart: exports.persistentStart,\r\n    addStateListener: exports.addStateListener,\r\n};\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.persistentStart = exports.persistentEnd = exports.registerStateListener = exports.registerOnStatsListener = exports.disconnect = exports.connect = exports.mapTrack = exports.mapStream = exports.addEvent = exports.enableDataCollection = exports.disableDataCollection = exports.addKeys = exports.setUserRating = exports.setConfig = exports.initSDK = void 0;\r\nvar watchrtcsocket_1 = require(\"./watchrtcsocket\");\r\nvar watchrtchttp_1 = require(\"./watchrtchttp\");\r\nvar utils_1 = require(\"./utils\");\r\nvar version_1 = require(\"./version\");\r\nvar standardGetstats = true;\r\nvar isFirefox = !!window.mozRTCPeerConnection;\r\nvar isSafari = !isFirefox && window.RTCPeerConnection && !window.navigator.webkitGetUserMedia;\r\n// Data structure for RTCPeerConnection related stuff we need\r\nvar openChannels = {};\r\nvar peerconnectioncounter = 0;\r\nvar connectionData = {};\r\nvar watchrtcIdentifiers = {\r\n    rtcRoomId: undefined,\r\n    rtcPeerId: undefined,\r\n    projectId: undefined,\r\n};\r\nvar watchrtcConfig = null;\r\nvar http = null;\r\nvar socket = null;\r\nvar trace;\r\nvar lastConnectionOpen = 0; // so we know when was the last active connection seen\r\nvar getStatsInterval;\r\nvar tryingToConnectSocket = false;\r\nvar hardwareInfo;\r\nvar currentAudioOutputId;\r\nvar authFailed = false;\r\nvar reconnectTimerId;\r\nvar isManualConnect = false;\r\nvar isManualDisconnect = false;\r\nvar getStatsCallback;\r\nvar stateListener = null;\r\nvar debugLog = utils_1.debugLog.bind(null, function () { return watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.debug; });\r\n// Data structure for storing and applying mapTrack\r\nvar mappedTrack = {};\r\nvar maybeOpenWebsocketConnection = function (_a) {\r\n    var _b;\r\n    var _c = _a.forceRecreate, forceRecreate = _c === void 0 ? false : _c, _d = _a.reconnecting, reconnecting = _d === void 0 ? false : _d, _e = _a.pcId, pcId = _e === void 0 ? \"PC_unknown\" : _e;\r\n    debugLog(\"info\", \"maybeOpenWebsocketConnection called: [\".concat(pcId, \"]\"), {\r\n        forceRecreate: forceRecreate,\r\n        reconnecting: reconnecting,\r\n        isManualDisconnect: isManualDisconnect,\r\n        tryingToConnectSocket: tryingToConnectSocket,\r\n        watchrtcConfig: watchrtcConfig,\r\n        openChannels: JSON.stringify(openChannels),\r\n    });\r\n    isManualDisconnect = false;\r\n    var opened = ((_b = socket === null || socket === void 0 ? void 0 : socket.connection) === null || _b === void 0 ? void 0 : _b.readyState) === WebSocket.OPEN;\r\n    if (opened) {\r\n        var roomIdOrPeerIdChanged = (0, utils_1.isRoomIdOrPeerIdChanged)(watchrtcIdentifiers, watchrtcConfig);\r\n        if (roomIdOrPeerIdChanged && forceRecreate) {\r\n            debugLog(\"info\", \"maybeOpenWebsocketConnection. Closing WS connection. [\".concat(pcId, \"]\"));\r\n            socket === null || socket === void 0 ? void 0 : socket.close();\r\n        }\r\n        else {\r\n            debugLog(\"info\", \"maybeOpenWebsocketConnection. WS connection already opened [\".concat(pcId, \"]\"));\r\n            return;\r\n        }\r\n    }\r\n    var connectionCount = (0, utils_1.countOfValidConnections)(openChannels);\r\n    if (!isManualConnect && connectionCount < 1 && !tryingToConnectSocket) {\r\n        debugLog(\"info\", \"maybeOpenWebsocketConnection. WS connection not opened - previous connect call not finished or missing peer connection [\".concat(pcId, \"]\"), {\r\n            openChannels: JSON.stringify(openChannels),\r\n            connectionCount: connectionCount,\r\n            tryingToConnectSocket: tryingToConnectSocket,\r\n            isManualConnect: isManualConnect,\r\n        });\r\n        return;\r\n    }\r\n    var canConnect = (0, utils_1.validateConfig)(watchrtcConfig);\r\n    var id = Object.keys(openChannels)[connectionCount - 1]; // not very critical, but for consistency with trace\r\n    if (!canConnect) {\r\n        tryingToConnectSocket = false;\r\n        debugLog(\"info\", \"maybeOpenWebsocketConnection. WS connection not opened - invalid config [\".concat(pcId, \"]\"), {\r\n            watchrtcConfig: watchrtcConfig,\r\n        });\r\n        return;\r\n    }\r\n    if (watchrtcConfig.keys) {\r\n        Object.keys(watchrtcConfig.keys || {}).forEach(function (k) {\r\n            if (typeof watchrtcConfig.keys[k] === \"string\") {\r\n                watchrtcConfig.keys[k] = [watchrtcConfig.keys[k]];\r\n            }\r\n        });\r\n    }\r\n    var useToken = !!watchrtcConfig.rtcToken;\r\n    var wsConnectionData = (0, utils_1.getConnectionData)(\"ws\", useToken ? watchrtcConfig.rtcToken : watchrtcConfig.rtcApiKey, watchrtcConfig.proxyUrl);\r\n    if (!socket) {\r\n        debugLog(\"error\", \"maybeOpenWebsocketConnection. WS socket wasn't initialized [\".concat(pcId, \"]\"));\r\n    }\r\n    tryingToConnectSocket = true;\r\n    lastConnectionOpen = Date.now();\r\n    debugLog(\"info\", \"maybeOpenWebsocketConnection. Opening websocket connection [\".concat(pcId, \"]\"));\r\n    startStatsCollection();\r\n    var wsOpeningTimestamp = Date.now();\r\n    socket === null || socket === void 0 ? void 0 : socket.connect({\r\n        url: \"\".concat(wsConnectionData.url, \"?\").concat(useToken ? \"token\" : \"apiKey\", \"=\").concat(wsConnectionData.key, \"&timestamp=\").concat(Date.now()),\r\n        onData: function (data) {\r\n            var _a;\r\n            for (var _i = 0, _b = Object.entries(data); _i < _b.length; _i++) {\r\n                var _c = _b[_i], key = _c[0], value = _c[1];\r\n                connectionData[key] = value;\r\n            }\r\n            watchrtcIdentifiers.projectId = data.projectId;\r\n            tryingToConnectSocket = false;\r\n            watchrtcConfig.allowBrowserLogCollection = Boolean(data.collectConsoleLogEnabled);\r\n            if (!watchrtcConfig.allowBrowserLogCollection) {\r\n                (0, utils_1.restoreOriginalConsoleMethods)();\r\n                // clean up collected logs from socket buffer\r\n                if (socket === null || socket === void 0 ? void 0 : socket.buffer) {\r\n                    socket.buffer = socket.buffer.filter(function (data) { return data[0] !== \"log\"; });\r\n                }\r\n            }\r\n            else {\r\n                if (!((_a = watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.console) === null || _a === void 0 ? void 0 : _a.override) && data.collectConsoleLogLevel) {\r\n                    (0, utils_1.setConsoleLevel)(data.collectConsoleLogLevel, trace);\r\n                }\r\n            }\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"Connection established. watchRTCConnectionId: \".concat(data.connectionId, \" sdkVersion:\").concat(version_1.default, \" [\").concat(pcId, \"]\")], false));\r\n            trace({ data: [\"watchrtc\", id, __assign(__assign(__assign({}, watchrtcConfig), data), { sdkVersion: version_1.default })] });\r\n            if (reconnecting) {\r\n                trace({ data: [\"reconnect\", null, null] });\r\n            }\r\n            if (hardwareInfo) {\r\n                trace({ data: [\"hardware\", null, hardwareInfo] });\r\n            }\r\n            trace({ data: [\"sessionId\", null, window.watchRTCSessionId] });\r\n            if (data.interval === watchrtcConfig.collectionInterval) {\r\n                return;\r\n            }\r\n            var oldInterval = watchrtcConfig.collectionInterval;\r\n            watchrtcConfig.collectionInterval = data.interval;\r\n            resetConnectionState();\r\n            startStatsCollection();\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"Collection interval missmatch - connection state reset\"], false));\r\n            trace({ data: [\"collectionIntervalChange\", null, { oldInterval: oldInterval }] });\r\n        },\r\n        onError: function (_, type) {\r\n            if (type === \"auth\") {\r\n                authFailed = true;\r\n            }\r\n            tryingToConnectSocket = false;\r\n            lastConnectionOpen = 0;\r\n        },\r\n        onOpen: function () {\r\n            if (stateListener) {\r\n                stateListener({ connectionStatus: \"connected\" });\r\n            }\r\n            authFailed = false;\r\n            if (reconnectTimerId) {\r\n                clearInterval(reconnectTimerId);\r\n                reconnectTimerId = undefined;\r\n            }\r\n            var delta = Date.now() - wsOpeningTimestamp;\r\n            debugLog(\"info\", \"maybeOpenWebsocketConnection. Connection opened. Opening time - \".concat(delta, \" ms [\").concat(pcId, \"]\"));\r\n        },\r\n        onClose: function (closeEvent) {\r\n            if (stateListener) {\r\n                stateListener({ connectionStatus: \"disconnected\" });\r\n            }\r\n            var code = closeEvent.code, reason = closeEvent.reason, wasClean = closeEvent.wasClean;\r\n            debugLog(\"info\", \"close event\", { authFailed: authFailed, code: code, reason: reason, wasClean: wasClean });\r\n            if (authFailed) {\r\n                if (reconnectTimerId) {\r\n                    clearInterval(reconnectTimerId);\r\n                }\r\n            }\r\n            else if (!reconnectTimerId && !isManualDisconnect) {\r\n                maybeOpenWebsocketConnection({ reconnecting: true, pcId: pcId });\r\n                reconnectTimerId = setInterval(function () {\r\n                    maybeOpenWebsocketConnection({ reconnecting: true, pcId: pcId });\r\n                }, 30 * 1000);\r\n            }\r\n        },\r\n    });\r\n};\r\nvar startStatsCollection = function () {\r\n    window.clearInterval(getStatsInterval);\r\n    getStatsInterval = window.setInterval(function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var stats, _i, _a, pcInfo, _b, peer, streams;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        if (!(!isManualConnect && (0, utils_1.countOfValidConnections)(openChannels) === 0)) return [3 /*break*/, 1];\r\n                        debugLog(\"info\", \"getStatsInterval. No valid connections at this time\");\r\n                        // if we don't have any connection for 20 sec we can close the socket\r\n                        if (lastConnectionOpen && lastConnectionOpen + 20000 < Date.now()) {\r\n                            window.clearInterval(getStatsInterval);\r\n                            socket === null || socket === void 0 ? void 0 : socket.close();\r\n                            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"Last connection closed. watchRTCConnectionId: \".concat(connectionData === null || connectionData === void 0 ? void 0 : connectionData.connectionId, \" sdkVersion: \").concat(version_1.default)], false));\r\n                        }\r\n                        return [3 /*break*/, 6];\r\n                    case 1:\r\n                        lastConnectionOpen = Date.now();\r\n                        stats = { connections: {}, streams: {} };\r\n                        _i = 0, _a = Object.values(openChannels);\r\n                        _c.label = 2;\r\n                    case 2:\r\n                        if (!(_i < _a.length)) return [3 /*break*/, 5];\r\n                        pcInfo = _a[_i];\r\n                        debugLog(\"info\", \"getStatsInterval. \".concat(pcInfo.id, \" signalingState: \").concat(pcInfo.pc.signalingState));\r\n                        if (!(pcInfo.pc.signalingState !== \"closed\")) return [3 /*break*/, 4];\r\n                        return [4 /*yield*/, getStats(pcInfo)];\r\n                    case 3:\r\n                        _b = _c.sent(), peer = _b.peer, streams = _b.streams;\r\n                        stats.connections = __assign(__assign({}, stats.connections), peer);\r\n                        stats.streams = __assign(__assign({}, stats.streams), streams);\r\n                        _c.label = 4;\r\n                    case 4:\r\n                        _i++;\r\n                        return [3 /*break*/, 2];\r\n                    case 5:\r\n                        if (getStatsCallback) {\r\n                            getStatsCallback(stats);\r\n                        }\r\n                        _c.label = 6;\r\n                    case 6: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    }, watchrtcConfig.collectionInterval);\r\n};\r\nvar getStats = function (pcInfo) {\r\n    return new Promise(function (resolve, __reject) {\r\n        if (pcInfo) {\r\n            var id_1 = pcInfo.id, pc_1 = pcInfo.pc, prev_1 = pcInfo.prev;\r\n            if (standardGetstats || isFirefox || isSafari) {\r\n                pc_1.getStats(null).then(function (res) {\r\n                    if (watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.logGetStats) {\r\n                        debugLog(\"info\", \"getStats res\", { res: res });\r\n                    }\r\n                    var now = {};\r\n                    if (isFirefox) {\r\n                        res.forEach(function (report) {\r\n                            now[\"\".concat(report.type, \"_\").concat(report.id)] = report;\r\n                        });\r\n                    }\r\n                    else {\r\n                        now = (0, utils_1.map2obj)(res);\r\n                    }\r\n                    var base = JSON.parse(JSON.stringify(now)); // our new prev\r\n                    now = (0, utils_1.applyPatchForRTT)(prev_1, now);\r\n                    var data = (0, utils_1.deltaCompression)(prev_1, now);\r\n                    if (watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.logGetStats) {\r\n                        debugLog(\"info\", \"getStats(null) [\".concat(id_1, \"]\"), { data: data });\r\n                    }\r\n                    if ((data === null || data === void 0 ? void 0 : data.timestamp) !== null && (data === null || data === void 0 ? void 0 : data.timestamp) !== -Infinity) {\r\n                        trace({ data: [\"getstats\", id_1, data] });\r\n                    }\r\n                    pcInfo.prev = base;\r\n                    resolve((0, utils_1.exposeApplicationStatsForPC)(id_1, prev_1, now, mappedTrack));\r\n                });\r\n            }\r\n            else {\r\n                pc_1.getStats(function (res) {\r\n                    var now = (0, utils_1.mangleChromeStats)(pc_1, res);\r\n                    var base = JSON.parse(JSON.stringify(now)); // our new prev\r\n                    var data = (0, utils_1.deltaCompression)(prev_1, now);\r\n                    if (watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.logGetStats) {\r\n                        debugLog(\"info\", \"getStats() [\".concat(id_1, \"]\"), { data: data });\r\n                    }\r\n                    if ((data === null || data === void 0 ? void 0 : data.timestamp) !== null && (data === null || data === void 0 ? void 0 : data.timestamp) !== -Infinity) {\r\n                        trace({ data: [\"getstats\", id_1, data] });\r\n                    }\r\n                    pcInfo.prev = base;\r\n                    resolve((0, utils_1.exposeApplicationStatsForPC)(id_1, prev_1, now, mappedTrack));\r\n                });\r\n            }\r\n        }\r\n    });\r\n};\r\nvar getHardware = function () {\r\n    setTimeout(function () {\r\n        // if get hardware take more than 50 ms then do not save it\r\n        var getHardwareStartTime = Date.now();\r\n        (0, utils_1.getHardwareInfo)()\r\n            .then(function (hwInfo) {\r\n            var getHardwareTime = Date.now() - getHardwareStartTime;\r\n            if (getHardwareTime <= 50000) {\r\n                hardwareInfo = hwInfo;\r\n                debugLog(\"info\", \"getHardware\", { hardwareInfo: hardwareInfo });\r\n            }\r\n            else {\r\n                debugLog(\"info\", \"getHardware failure: getHardwareTime: \".concat(getHardwareTime), { hardwareInfo: hardwareInfo });\r\n            }\r\n        })\r\n            .catch(function (err) {\r\n            console.error(\"Error. Get hardware info: \".concat(err.message));\r\n        });\r\n    }, 0);\r\n};\r\n/**\r\n * Initialize SDK.\r\n * @param watchrtc\r\n * @param prefixesToWrap\r\n * @param services\r\n */\r\nvar initSDK = function (watchrtc, prefixesToWrap, services) {\r\n    var _a, _b;\r\n    var initialized = window.watchRTCInitialized;\r\n    if (initialized) {\r\n        return;\r\n    }\r\n    var isRTCPeerConnectionNative = RTCPeerConnection.toString().indexOf(\"[native code]\") !== -1;\r\n    if (!isRTCPeerConnectionNative) {\r\n        console.warn.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"init. RTCPeerConnection object has been already overridden\"], false));\r\n    }\r\n    window.watchRTCInitialized = true;\r\n    window.watchRTCSessionId = (0, utils_1.generateID)();\r\n    getHardware();\r\n    var urlParams = new URLSearchParams(location.search);\r\n    if (urlParams.has(\"watchrtc\") && urlParams.get(\"watchrtc\") === \"debug\") {\r\n        watchrtc.debug = true;\r\n    }\r\n    socket = (services === null || services === void 0 ? void 0 : services.socketService) || new watchrtcsocket_1.default({ debug: watchrtc === null || watchrtc === void 0 ? void 0 : watchrtc.debug });\r\n    http = (services === null || services === void 0 ? void 0 : services.httpService) || new watchrtchttp_1.default({ debug: watchrtc === null || watchrtc === void 0 ? void 0 : watchrtc.debug });\r\n    watchrtc.collectionInterval = (_a = watchrtc.collectionInterval) !== null && _a !== void 0 ? _a : 8000;\r\n    watchrtcConfig = watchrtc;\r\n    watchrtcIdentifiers.rtcRoomId = watchrtcConfig.rtcRoomId;\r\n    watchrtcIdentifiers.rtcPeerId = watchrtcConfig.rtcPeerId;\r\n    trace = socket.trace;\r\n    if (watchrtcConfig.wsUrl) {\r\n        console.warn.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"\\\"wsUrl\\\" config property is deprecated. Use \\\"proxyUrl\\\" instead of it\"], false));\r\n    }\r\n    if (watchrtcConfig.proxyUrl) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"\\\"proxyUrl\\\" is used\"], false));\r\n    }\r\n    prefixesToWrap.forEach(function (prefix) {\r\n        if (!window[prefix + \"RTCPeerConnection\"]) {\r\n            return;\r\n        }\r\n        var origPeerConnection = window[prefix + \"RTCPeerConnection\"];\r\n        var peerconnection = function (config, constraints) {\r\n            if (config === null || config === void 0 ? void 0 : config.watchrtc) {\r\n                watchrtcConfig = __assign(__assign({}, watchrtcConfig), config.watchrtc);\r\n            }\r\n            debugLog(\"info\", \"new RTCPeerConnection called.\", {\r\n                config: config,\r\n                constraints: constraints,\r\n            });\r\n            var pc = new origPeerConnection(config, constraints);\r\n            var id = \"PC_\" + peerconnectioncounter++;\r\n            pc.__rtcStatsId = id;\r\n            openChannels[id] = {\r\n                id: id,\r\n                pc: pc,\r\n                validConnection: false,\r\n            };\r\n            if (!config) {\r\n                config = { nullConfig: true };\r\n            }\r\n            config = JSON.parse(JSON.stringify(config)); // deepcopy\r\n            // don't log credentials\r\n            ((config && config.iceServers) || []).forEach(function (server) {\r\n                delete server.credential;\r\n            });\r\n            if (config === null || config === void 0 ? void 0 : config.watchrtc) {\r\n                delete config.watchrtc;\r\n            }\r\n            if (isFirefox) {\r\n                config.browserType = \"moz\";\r\n            }\r\n            else {\r\n                config.browserType = \"webkit\";\r\n            }\r\n            trace({ data: [\"create\", id, config] });\r\n            // TODO: do we want to log constraints here? They are chrome-proprietary.\r\n            // http://stackoverflow.com/questions/31003928/what-do-each-of-these-experimental-goog-rtcpeerconnectionconstraints-do\r\n            if (constraints) {\r\n                trace({ data: [\"constraints\", id, constraints] });\r\n            }\r\n            pc.addEventListener(\"icecandidate\", function (e) {\r\n                trace({ data: [\"onicecandidate\", id, e.candidate] });\r\n            });\r\n            pc.addEventListener(\"icecandidateerror\", function (e) {\r\n                trace({ data: [\"onicecandidateerror\", id, e] });\r\n            });\r\n            pc.addEventListener(\"addstream\", function (e) {\r\n                trace({\r\n                    data: [\r\n                        \"onaddstream\",\r\n                        id,\r\n                        e.stream.id +\r\n                            \" \" +\r\n                            e.stream.getTracks().map(function (t) {\r\n                                return t.kind + \":\" + t.id;\r\n                            }),\r\n                    ],\r\n                });\r\n            });\r\n            pc.addEventListener(\"track\", function (e) {\r\n                trace({\r\n                    data: [\r\n                        \"ontrack\",\r\n                        id,\r\n                        e.track.kind +\r\n                            \":\" +\r\n                            e.track.id +\r\n                            \" state:\" +\r\n                            e.track.readyState +\r\n                            \" muted:\" +\r\n                            e.track.muted +\r\n                            \" \" +\r\n                            e.streams.map(function (stream) {\r\n                                return \"stream:\" + stream.id;\r\n                            }),\r\n                    ],\r\n                });\r\n                // https://redmine.testrtc.com/issues/7166\r\n                e.track.onended = function () {\r\n                    trace({\r\n                        data: [\r\n                            \"ontrack\",\r\n                            id,\r\n                            e.track.kind +\r\n                                \":\" +\r\n                                e.track.id +\r\n                                \" state:\" +\r\n                                e.track.readyState +\r\n                                \" \" +\r\n                                e.streams.map(function (stream) {\r\n                                    return \"stream:\" + stream.id;\r\n                                }),\r\n                        ],\r\n                    });\r\n                };\r\n                e.track.onmute = function () {\r\n                    trace({\r\n                        data: [\r\n                            \"ontrack\",\r\n                            id,\r\n                            e.track.kind +\r\n                                \":\" +\r\n                                e.track.id +\r\n                                \" state:\" +\r\n                                e.track.readyState +\r\n                                \" muted:\" +\r\n                                e.track.muted +\r\n                                \" \" +\r\n                                e.streams.map(function (stream) {\r\n                                    return \"stream:\" + stream.id;\r\n                                }),\r\n                        ],\r\n                    });\r\n                };\r\n                e.track.onunmute = function () {\r\n                    trace({\r\n                        data: [\r\n                            \"ontrack\",\r\n                            id,\r\n                            e.track.kind +\r\n                                \":\" +\r\n                                e.track.id +\r\n                                \" state:\" +\r\n                                e.track.readyState +\r\n                                \" muted:\" +\r\n                                e.track.muted +\r\n                                \" \" +\r\n                                e.streams.map(function (stream) {\r\n                                    return \"stream:\" + stream.id;\r\n                                }),\r\n                        ],\r\n                    });\r\n                };\r\n            });\r\n            pc.addEventListener(\"removestream\", function (e) {\r\n                trace({\r\n                    data: [\r\n                        \"onremovestream\",\r\n                        id,\r\n                        e.stream.id +\r\n                            \" \" +\r\n                            e.stream.getTracks().map(function (t) {\r\n                                return t.kind + \":\" + t.id;\r\n                            }),\r\n                    ],\r\n                });\r\n            });\r\n            pc.addEventListener(\"signalingstatechange\", function () {\r\n                if (openChannels[id] && !openChannels[id].validConnection) {\r\n                    openChannels[id].validConnection = true;\r\n                    setTimeout(function () {\r\n                        maybeOpenWebsocketConnection({ forceRecreate: true, pcId: id });\r\n                    }, 5000);\r\n                }\r\n                else {\r\n                    debugLog(\"info\", \"signalingstatechage. WS connection opening not triggered - peer connection not in channels or was already opened [\".concat(id, \"]\"), { openChannels: JSON.stringify(openChannels) });\r\n                }\r\n                trace({ data: [\"onsignalingstatechange\", id, pc.signalingState] });\r\n            });\r\n            pc.addEventListener(\"iceconnectionstatechange\", function () {\r\n                trace({ data: [\"oniceconnectionstatechange\", id, pc.iceConnectionState] });\r\n            });\r\n            pc.addEventListener(\"icegatheringstatechange\", function () {\r\n                trace({ data: [\"onicegatheringstatechange\", id, pc.iceGatheringState] });\r\n            });\r\n            pc.addEventListener(\"connectionstatechange\", function () {\r\n                trace({ data: [\"onconnectionstatechange\", id, pc.connectionState] });\r\n            });\r\n            pc.addEventListener(\"negotiationneeded\", function () {\r\n                trace({ data: [\"onnegotiationneeded\", id, undefined] });\r\n            });\r\n            pc.addEventListener(\"datachannel\", function (event) {\r\n                trace({ data: [\"ondatachannel\", id, [event.channel.id, event.channel.label]] });\r\n            });\r\n            // https://redmine.testrtc.com/issues/6529\r\n            // pc.addEventListener(\"iceconnectionstatechange\", () => {\r\n            //   if (pc.iceConnectionState === \"connected\") {\r\n            //     getStats(openChannels[id]);\r\n            //   }\r\n            // });\r\n            return pc;\r\n        };\r\n        if (\"HTMLMediaElement\" in window && \"setSinkId\" in HTMLMediaElement.prototype) {\r\n            var nativeMethod_1 = HTMLMediaElement.prototype.setSinkId;\r\n            HTMLMediaElement.prototype.setSinkId = function () {\r\n                var selectedDeviceId = arguments[0];\r\n                navigator.mediaDevices\r\n                    .enumerateDevices()\r\n                    .then(function (devices) {\r\n                    var currentDevice = devices.find(function (_a) {\r\n                        var deviceId = _a.deviceId;\r\n                        return deviceId === selectedDeviceId;\r\n                    });\r\n                    if (currentDevice && currentDevice.deviceId !== currentAudioOutputId) {\r\n                        trace({ data: [\"audioOutputChange\", null, currentDevice.label] });\r\n                    }\r\n                    currentAudioOutputId = selectedDeviceId;\r\n                })\r\n                    .catch(function (error) {\r\n                    debugLog(\"error\", error.message, { error: error });\r\n                });\r\n                return nativeMethod_1.apply(this, arguments);\r\n            };\r\n        }\r\n        // wrap RTCRtpTransceiver.setCodecPreferences\r\n        if (\"RTCRtpTransceiver\" in window && \"setCodecPreferences\" in window.RTCRtpTransceiver.prototype) {\r\n            var origRTCRtpTransceiver = window.RTCRtpTransceiver;\r\n            var nativeMethod_2 = origRTCRtpTransceiver.prototype.setCodecPreferences;\r\n            origRTCRtpTransceiver.prototype.setCodecPreferences = function () {\r\n                trace({ data: [\"setCodecPreferences\", this.__pcId, arguments] });\r\n                return nativeMethod_2.apply(this, arguments);\r\n            };\r\n        }\r\n        // wrap RTCRtpSender.setParameters\r\n        if (\"RTCRtpSender\" in window && \"setParameters\" in window.RTCRtpSender.prototype) {\r\n            var origRTCRtpSender = window.RTCRtpSender;\r\n            var nativeMethod_3 = origRTCRtpSender.prototype.setParameters;\r\n            origRTCRtpSender.prototype.setParameters = function () {\r\n                trace({ data: [\"setParameters\", this.__pcId, arguments] });\r\n                return nativeMethod_3.apply(this, arguments);\r\n            };\r\n        }\r\n        // wrap RTCRtpSender.replaceTrack\r\n        if (\"RTCRtpSender\" in window && \"replaceTrack\" in window.RTCRtpSender.prototype) {\r\n            var origRTCRtpSender = window.RTCRtpSender;\r\n            var nativeMethod_4 = origRTCRtpSender.prototype.replaceTrack;\r\n            origRTCRtpSender.prototype.replaceTrack = function () {\r\n                var track = arguments[0];\r\n                if (track) {\r\n                    trace({\r\n                        data: [\r\n                            \"replaceTrack\",\r\n                            this.__pcId,\r\n                            track.kind +\r\n                                \":\" +\r\n                                track.id +\r\n                                \" state:\" +\r\n                                track.readyState +\r\n                                \" muted:\" +\r\n                                track.muted +\r\n                                \" label:\" +\r\n                                track.label,\r\n                        ],\r\n                    });\r\n                }\r\n                else {\r\n                    trace({ data: [\"replaceTrack\", this.__pcId, null] });\r\n                }\r\n                return nativeMethod_4.apply(this, arguments);\r\n            };\r\n        }\r\n        // adding pc id to sender for above logic\r\n        [\"addTransceiver\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var _this_1 = this;\r\n                    var streams = \"\";\r\n                    if (arguments[1] && arguments[1].streams) {\r\n                        streams = arguments[1].streams.map(function (s) { return \"stream:\" + s.id; }).join(\";\");\r\n                    }\r\n                    var trackOrKind = typeof arguments[0] === \"string\"\r\n                        ? arguments[0]\r\n                        : arguments[0].kind + \":\" + arguments[0].id + \" \" + arguments[0].label;\r\n                    var init = arguments[1] ? __assign(__assign({}, arguments[1]), { streams: streams }) : null;\r\n                    trace({ data: [method, this.__rtcStatsId, [trackOrKind, init]] });\r\n                    var transceiver = nativeMethod.apply(this, arguments);\r\n                    transceiver.sender.__pcId = this.__rtcStatsId;\r\n                    // https://redmine.testrtc.com/issues/7166\r\n                    var track = arguments[0];\r\n                    if (typeof track === \"object\") {\r\n                        trace({\r\n                            data: [\r\n                                \"onlocaltrack\",\r\n                                this.__rtcStatsId,\r\n                                track.kind +\r\n                                    \":\" +\r\n                                    track.id +\r\n                                    \" state:\" +\r\n                                    track.readyState +\r\n                                    \" muted:\" +\r\n                                    track.muted +\r\n                                    \" label:\" +\r\n                                    track.label,\r\n                            ],\r\n                        });\r\n                        track.onended = function () {\r\n                            trace({\r\n                                data: [\r\n                                    \"onlocaltrack\",\r\n                                    _this_1.__rtcStatsId,\r\n                                    track.kind + \":\" + track.id + \" state:\" + track.readyState + \" label:\" + track.label,\r\n                                ],\r\n                            });\r\n                        };\r\n                        track.onmute = function () {\r\n                            trace({\r\n                                data: [\r\n                                    \"onlocaltrack\",\r\n                                    _this_1.__rtcStatsId,\r\n                                    track.kind +\r\n                                        \":\" +\r\n                                        track.id +\r\n                                        \" state:\" +\r\n                                        track.readyState +\r\n                                        \" muted:\" +\r\n                                        track.muted +\r\n                                        \" label:\" +\r\n                                        track.label,\r\n                                ],\r\n                            });\r\n                        };\r\n                        track.onunmute = function () {\r\n                            trace({\r\n                                data: [\r\n                                    \"onlocaltrack\",\r\n                                    _this_1.__rtcStatsId,\r\n                                    track.kind +\r\n                                        \":\" +\r\n                                        track.id +\r\n                                        \" state:\" +\r\n                                        track.readyState +\r\n                                        \" muted:\" +\r\n                                        track.muted +\r\n                                        \" label:\" +\r\n                                        track.label,\r\n                                ],\r\n                            });\r\n                        };\r\n                    }\r\n                    return transceiver;\r\n                };\r\n            }\r\n        });\r\n        [\"createDataChannel\", \"restartIce\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    trace({ data: [method, this.__rtcStatsId, arguments] });\r\n                    return nativeMethod.apply(this, arguments);\r\n                };\r\n            }\r\n        });\r\n        [\"close\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    trace({ data: [method, this.__rtcStatsId, arguments] });\r\n                    delete openChannels[this.__rtcStatsId];\r\n                    isManualDisconnect = true;\r\n                    debugLog(\"info\", \"on RTCPeerConnection(\".concat(this.__rtcStatsId, \") close\"));\r\n                    return nativeMethod.apply(this, arguments);\r\n                };\r\n            }\r\n        });\r\n        [\"addStream\", \"removeStream\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var _this_1 = this;\r\n                    var stream = arguments[0];\r\n                    var streamInfo = stream\r\n                        .getTracks()\r\n                        .map(function (t) {\r\n                        return t.kind + \":\" + t.id;\r\n                    })\r\n                        .join(\",\");\r\n                    trace({ data: [method, this.__rtcStatsId, stream.id + \" \" + streamInfo] });\r\n                    // https://redmine.testrtc.com/issues/7166\r\n                    if (method === \"addStream\") {\r\n                        stream.getTracks().map(function (track) {\r\n                            trace({\r\n                                data: [\r\n                                    \"onlocaltrack\",\r\n                                    _this_1.__rtcStatsId,\r\n                                    track.kind +\r\n                                        \":\" +\r\n                                        track.id +\r\n                                        \" state:\" +\r\n                                        track.readyState +\r\n                                        \" muted:\" +\r\n                                        track.muted +\r\n                                        \" label:\" +\r\n                                        track.label +\r\n                                        \" \" +\r\n                                        stream.id,\r\n                                ],\r\n                            });\r\n                            track.onended = function () {\r\n                                trace({\r\n                                    data: [\r\n                                        \"onlocaltrack\",\r\n                                        _this_1.__rtcStatsId,\r\n                                        track.kind +\r\n                                            \":\" +\r\n                                            track.id +\r\n                                            \" state:\" +\r\n                                            track.readyState +\r\n                                            \" label:\" +\r\n                                            track.label +\r\n                                            \" \" +\r\n                                            stream.id,\r\n                                    ],\r\n                                });\r\n                            };\r\n                            track.onmute = function () {\r\n                                trace({\r\n                                    data: [\r\n                                        \"onlocaltrack\",\r\n                                        _this_1.__rtcStatsId,\r\n                                        track.kind +\r\n                                            \":\" +\r\n                                            track.id +\r\n                                            \" state:\" +\r\n                                            track.readyState +\r\n                                            \" muted:\" +\r\n                                            track.muted +\r\n                                            \" label:\" +\r\n                                            track.label +\r\n                                            \" \" +\r\n                                            stream.id,\r\n                                    ],\r\n                                });\r\n                            };\r\n                            track.onunmute = function () {\r\n                                trace({\r\n                                    data: [\r\n                                        \"onlocaltrack\",\r\n                                        _this_1.__rtcStatsId,\r\n                                        track.kind +\r\n                                            \":\" +\r\n                                            track.id +\r\n                                            \" state:\" +\r\n                                            track.readyState +\r\n                                            \" muted:\" +\r\n                                            track.muted +\r\n                                            \" label:\" +\r\n                                            track.label +\r\n                                            \" \" +\r\n                                            stream.id,\r\n                                    ],\r\n                                });\r\n                            };\r\n                        });\r\n                    }\r\n                    return nativeMethod.apply(this, arguments);\r\n                };\r\n            }\r\n        });\r\n        [\"addTrack\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var _this_1 = this;\r\n                    var track = arguments[0];\r\n                    var streams = [].slice.call(arguments, 1);\r\n                    trace({\r\n                        data: [\r\n                            method,\r\n                            this.__rtcStatsId,\r\n                            track.kind +\r\n                                \":\" +\r\n                                track.id +\r\n                                \" \" +\r\n                                track.label +\r\n                                \" \" +\r\n                                (streams\r\n                                    .map(function (s) {\r\n                                    return \"stream:\" + s.id;\r\n                                })\r\n                                    .join(\";\") || \"-\"),\r\n                        ],\r\n                    });\r\n                    // https://redmine.testrtc.com/issues/7166\r\n                    trace({\r\n                        data: [\r\n                            \"onlocaltrack\",\r\n                            this.__rtcStatsId,\r\n                            track.kind +\r\n                                \":\" +\r\n                                track.id +\r\n                                \" state:\" +\r\n                                track.readyState +\r\n                                \" muted:\" +\r\n                                track.muted +\r\n                                \" label:\" +\r\n                                track.label +\r\n                                \" \" +\r\n                                streams.map(function (stream) {\r\n                                    return \"stream:\" + stream.id;\r\n                                }),\r\n                        ],\r\n                    });\r\n                    track.onended = function () {\r\n                        trace({\r\n                            data: [\r\n                                \"onlocaltrack\",\r\n                                _this_1.__rtcStatsId,\r\n                                track.kind +\r\n                                    \":\" +\r\n                                    track.id +\r\n                                    \" state:\" +\r\n                                    track.readyState +\r\n                                    \" label:\" +\r\n                                    track.label +\r\n                                    \" \" +\r\n                                    streams.map(function (stream) {\r\n                                        return \"stream:\" + stream.id;\r\n                                    }),\r\n                            ],\r\n                        });\r\n                    };\r\n                    track.onmute = function () {\r\n                        trace({\r\n                            data: [\r\n                                \"onlocaltrack\",\r\n                                _this_1.__rtcStatsId,\r\n                                track.kind +\r\n                                    \":\" +\r\n                                    track.id +\r\n                                    \" state:\" +\r\n                                    track.readyState +\r\n                                    \" muted:\" +\r\n                                    track.muted +\r\n                                    \" label:\" +\r\n                                    track.label +\r\n                                    \" \" +\r\n                                    streams.map(function (stream) {\r\n                                        return \"stream:\" + stream.id;\r\n                                    }),\r\n                            ],\r\n                        });\r\n                    };\r\n                    track.onunmute = function () {\r\n                        trace({\r\n                            data: [\r\n                                \"onlocaltrack\",\r\n                                _this_1.__rtcStatsId,\r\n                                track.kind +\r\n                                    \":\" +\r\n                                    track.id +\r\n                                    \" state:\" +\r\n                                    track.readyState +\r\n                                    \" muted:\" +\r\n                                    track.muted +\r\n                                    \" label:\" +\r\n                                    track.label +\r\n                                    \" \" +\r\n                                    streams.map(function (stream) {\r\n                                        return \"stream:\" + stream.id;\r\n                                    }),\r\n                            ],\r\n                        });\r\n                    };\r\n                    var sender = nativeMethod.apply(this, arguments);\r\n                    sender.__pcId = this.__rtcStatsId;\r\n                    // Associate the peer id to the existing transceivers\r\n                    var transceivers = this.getTransceivers();\r\n                    if (transceivers) {\r\n                        transceivers.forEach(function (transceiver) {\r\n                            transceiver.__pcId = _this_1.__rtcStatsId;\r\n                        });\r\n                    }\r\n                    return sender;\r\n                };\r\n            }\r\n        });\r\n        [\"removeTrack\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var track = arguments[0].track;\r\n                    trace({\r\n                        data: [method, this.__rtcStatsId, track ? track.kind + \":\" + track.id + \" \" + track.label : \"null\"],\r\n                    });\r\n                    return nativeMethod.apply(this, arguments);\r\n                };\r\n            }\r\n        });\r\n        [\"createOffer\", \"createAnswer\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var rtcStatsId = this.__rtcStatsId;\r\n                    var args = arguments;\r\n                    var opts;\r\n                    if (arguments.length === 1 && typeof arguments[0] === \"object\") {\r\n                        opts = arguments[0];\r\n                    }\r\n                    else if (arguments.length === 3 && typeof arguments[2] === \"object\") {\r\n                        opts = arguments[2];\r\n                    }\r\n                    trace({ data: [method, this.__rtcStatsId, opts] });\r\n                    return nativeMethod.apply(this, opts ? [opts] : undefined).then(function (description) {\r\n                        trace({ data: [method + \"OnSuccess\", rtcStatsId, description] });\r\n                        if (args.length > 0 && typeof args[0] === \"function\") {\r\n                            args[0].apply(null, [description]);\r\n                            return undefined;\r\n                        }\r\n                        return description;\r\n                    }, function (err) {\r\n                        trace({ data: [method + \"OnFailure\", rtcStatsId, err.toString()] });\r\n                        if (args.length > 1 && typeof args[1] === \"function\") {\r\n                            args[1].apply(null, [err]);\r\n                            return;\r\n                        }\r\n                        throw err;\r\n                    });\r\n                };\r\n            }\r\n        });\r\n        [\"setLocalDescription\", \"setRemoteDescription\", \"addIceCandidate\"].forEach(function (method) {\r\n            var nativeMethod = origPeerConnection.prototype[method];\r\n            if (nativeMethod) {\r\n                origPeerConnection.prototype[method] = function () {\r\n                    var rtcStatsId = this.__rtcStatsId;\r\n                    var args = arguments;\r\n                    var _this = this;\r\n                    // because of setLocalDescription(null) sometimes we don't have SDP value\r\n                    // fippo suggested: Access pc.localDescription.sdp in the successcallback\r\n                    var needToHandleSDPInSuccessCallback = method === \"setLocalDescription\" && (!args[0] || (args[0] && !args[0].sdp));\r\n                    trace({\r\n                        data: [method, this.__rtcStatsId, needToHandleSDPInSuccessCallback ? { parameterless: true } : args[0]],\r\n                    });\r\n                    return nativeMethod.apply(this, [args[0]]).then(function () {\r\n                        trace({\r\n                            data: [\r\n                                method + \"OnSuccess\",\r\n                                rtcStatsId,\r\n                                needToHandleSDPInSuccessCallback ? _this === null || _this === void 0 ? void 0 : _this.localDescription : undefined,\r\n                            ],\r\n                        });\r\n                        if (args.length >= 2 && typeof args[1] === \"function\") {\r\n                            args[1].apply(null, []);\r\n                            return undefined;\r\n                        }\r\n                        return undefined;\r\n                    }, function (err) {\r\n                        trace({ data: [method + \"OnFailure\", rtcStatsId, err.toString()] });\r\n                        if (args.length >= 3 && typeof args[2] === \"function\") {\r\n                            args[2].apply(null, [err]);\r\n                            return undefined;\r\n                        }\r\n                        throw err;\r\n                    });\r\n                };\r\n            }\r\n        });\r\n        // wrap static methods. Currently just generateCertificate.\r\n        if (origPeerConnection.generateCertificate) {\r\n            Object.defineProperty(peerconnection, \"generateCertificate\", {\r\n                get: function () {\r\n                    return arguments.length\r\n                        ? origPeerConnection.generateCertificate.apply(null, arguments)\r\n                        : origPeerConnection.generateCertificate;\r\n                },\r\n            });\r\n        }\r\n        window[prefix + \"RTCPeerConnection\"] = peerconnection;\r\n        window[prefix + \"RTCPeerConnection\"].prototype = origPeerConnection.prototype;\r\n    });\r\n    // getUserMedia wrappers\r\n    prefixesToWrap.forEach(function (prefix) {\r\n        var name = prefix + (prefix.length ? \"GetUserMedia\" : \"getUserMedia\");\r\n        if (!navigator[name]) {\r\n            return;\r\n        }\r\n        var origGetUserMedia = navigator[name].bind(navigator);\r\n        var gum = function () {\r\n            trace({ data: [\"getUserMedia\", null, arguments[0]] });\r\n            var cb = arguments[1];\r\n            var eb = arguments[2];\r\n            origGetUserMedia(arguments[0], function (stream) {\r\n                // we log the stream id, track ids and tracks readystate since that is ended GUM fails\r\n                // to acquire the cam (in chrome)\r\n                trace({ data: [\"getUserMediaOnSuccess\", null, (0, utils_1.dumpStream)(stream)] });\r\n                if (cb) {\r\n                    cb(stream);\r\n                }\r\n            }, function (err) {\r\n                var errorData = [\"getUserMediaOnFailure\", null, err.name];\r\n                trace({ data: errorData });\r\n                httpReportError(errorData);\r\n                if (eb) {\r\n                    eb(err);\r\n                }\r\n            });\r\n        };\r\n        navigator[name] = gum.bind(navigator);\r\n    });\r\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n        var origGetUserMedia_1 = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\r\n        var gum = function () {\r\n            trace({ data: [\"navigator.mediaDevices.getUserMedia\", null, arguments[0]] });\r\n            return origGetUserMedia_1.apply(navigator.mediaDevices, arguments).then(function (stream) {\r\n                trace({ data: [\"navigator.mediaDevices.getUserMediaOnSuccess\", null, (0, utils_1.dumpStream)(stream)] });\r\n                return stream;\r\n            }, function (err) {\r\n                var errorData = [\"navigator.mediaDevices.getUserMediaOnFailure\", null, err.name];\r\n                trace({ data: errorData });\r\n                httpReportError(errorData);\r\n                return Promise.reject(err);\r\n            });\r\n        };\r\n        navigator.mediaDevices.getUserMedia = gum.bind(navigator.mediaDevices);\r\n    }\r\n    // getDisplayMedia\r\n    if (navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\r\n        var origGetDisplayMedia_1 = navigator.mediaDevices.getDisplayMedia.bind(navigator.mediaDevices);\r\n        var gdm = function () {\r\n            trace({ data: [\"navigator.mediaDevices.getDisplayMedia\", null, arguments[0]] });\r\n            return origGetDisplayMedia_1.apply(navigator.mediaDevices, arguments).then(function (stream) {\r\n                trace({ data: [\"navigator.mediaDevices.getDisplayMediaOnSuccess\", null, (0, utils_1.dumpStream)(stream)] });\r\n                return stream;\r\n            }, function (err) {\r\n                var errorData = [\"navigator.mediaDevices.getDisplayMediaOnFailure\", null, err.name];\r\n                trace({ data: errorData });\r\n                httpReportError(errorData);\r\n                return Promise.reject(err);\r\n            });\r\n        };\r\n        navigator.mediaDevices.getDisplayMedia = gdm.bind(navigator.mediaDevices);\r\n    }\r\n    if ((_b = watchrtc.console) === null || _b === void 0 ? void 0 : _b.level) {\r\n        (0, utils_1.setConsoleLevel)(watchrtc.console.level, trace);\r\n    }\r\n};\r\nexports.initSDK = initSDK;\r\nvar setConfig = function (newWatchrtcConfig) {\r\n    var _a;\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    var collectConsoleDisabled = (watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.allowBrowserLogCollection) === false;\r\n    if (!collectConsoleDisabled && ((_a = newWatchrtcConfig === null || newWatchrtcConfig === void 0 ? void 0 : newWatchrtcConfig.console) === null || _a === void 0 ? void 0 : _a.override) === true && newWatchrtcConfig.console.level) {\r\n        (0, utils_1.setConsoleLevel)(newWatchrtcConfig.console.level, trace);\r\n    }\r\n    if (\"collectionInterval\" in newWatchrtcConfig) {\r\n        delete newWatchrtcConfig.collectionInterval;\r\n    }\r\n    watchrtcConfig = __assign(__assign({}, watchrtcConfig), newWatchrtcConfig);\r\n    watchrtcIdentifiers.rtcRoomId = watchrtcConfig.rtcRoomId;\r\n    watchrtcIdentifiers.rtcPeerId = watchrtcConfig.rtcPeerId;\r\n    debugLog(\"info\", \"setConfig\", { newWatchrtcConfig: newWatchrtcConfig, watchrtcConfig: watchrtcConfig });\r\n    maybeOpenWebsocketConnection({});\r\n};\r\nexports.setConfig = setConfig;\r\n/**\r\n * Set user rating and/or comment for peer session\r\n * @param rating number from 1 to 5\r\n * @param comment string\r\n */\r\nvar setUserRating = function (\r\n/** 1 | 2 | 3 | 4 | 5 */\r\nrating, ratingComment) {\r\n    var _a;\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"SDK is not initialized. Use 'init' function first.\"], false));\r\n        return Promise.resolve({ error: \"SDK is not initialized. Use 'init' function first.\" });\r\n    }\r\n    var isValidRating = (0, utils_1.validateRating)(rating);\r\n    if (!isValidRating) {\r\n        return Promise.resolve({ error: \"Rating is invalid\" });\r\n    }\r\n    var opened = ((_a = socket === null || socket === void 0 ? void 0 : socket.connection) === null || _a === void 0 ? void 0 : _a.readyState) === WebSocket.OPEN;\r\n    var data = [\"userRating\", null, { rating: rating, ratingComment: ratingComment }];\r\n    return new Promise(function (resolve, reject) {\r\n        var options = { promiseFuncs: { resolve: resolve, reject: reject } };\r\n        if (opened) {\r\n            trace({ data: data, options: options });\r\n        }\r\n        else {\r\n            httpTrace.apply(void 0, data).then(function () { return resolve({}); })\r\n                .catch(function (error) { return resolve({ error: error }); });\r\n        }\r\n    });\r\n};\r\nexports.setUserRating = setUserRating;\r\n/**\r\n * Add keys for peer session\r\n * @param keys\r\n */\r\nvar addKeys = function (\r\n/** { \"key1\": \"value1\", \"key2\": [\"value2_1\", \"value2_2\"]} */\r\nkeys) {\r\n    var _a;\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    Object.keys(keys || {}).forEach(function (k) {\r\n        if (typeof keys[k] === \"string\") {\r\n            keys[k] = [keys[k]];\r\n        }\r\n    });\r\n    var data = [\"keys\", null, keys];\r\n    var opened = ((_a = socket === null || socket === void 0 ? void 0 : socket.connection) === null || _a === void 0 ? void 0 : _a.readyState) === WebSocket.OPEN;\r\n    var wasConnected = socket === null || socket === void 0 ? void 0 : socket.wasConnected;\r\n    return new Promise(function (resolve, reject) {\r\n        var options = { promiseFuncs: { resolve: resolve, reject: reject } };\r\n        if (opened) {\r\n            trace({ data: data, options: options });\r\n        }\r\n        else if (!wasConnected) {\r\n            trace({ data: data, options: options });\r\n        }\r\n        else {\r\n            httpTrace.apply(void 0, data).then(function () { return resolve({}); })\r\n                .catch(function (error) { return resolve({ error: error }); });\r\n        }\r\n    });\r\n};\r\nexports.addKeys = addKeys;\r\nvar disableDataCollection = function () {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    socket === null || socket === void 0 ? void 0 : socket.disableDataCollection();\r\n};\r\nexports.disableDataCollection = disableDataCollection;\r\nvar enableDataCollection = function () {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    socket === null || socket === void 0 ? void 0 : socket.enableDataCollection();\r\n};\r\nexports.enableDataCollection = enableDataCollection;\r\nvar addEvent = function (event) {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"addEvent error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    // const opened = socket?.connection?.readyState === WebSocket.OPEN;\r\n    // if (!opened && socket?.wasConnected) {\r\n    //   console.info(...logPrefix(\"error\"), `addEvent error. Connection has been closed.`);\r\n    //   return;\r\n    // }\r\n    var isEventValid = (0, utils_1.validateEvent)(event);\r\n    if (!isEventValid) {\r\n        return;\r\n    }\r\n    var data = [\"event\", null, event];\r\n    return new Promise(function (resolve, reject) {\r\n        var options = { promiseFuncs: { resolve: resolve, reject: reject } };\r\n        trace({ data: data, options: options });\r\n    });\r\n};\r\nexports.addEvent = addEvent;\r\nvar mapStream = function (id, name) {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"mapStream error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    var isDataValid = !!id && !!name;\r\n    if (!isDataValid) {\r\n        return;\r\n    }\r\n    var data = [\"mapStream\", null, { id: id, name: name }];\r\n    console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"mapStream method is deprecated. Please use mapTrack instead.\"], false));\r\n    trace({ data: data });\r\n};\r\nexports.mapStream = mapStream;\r\nvar mapTrack = function (id, name) {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"mapTrack error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    var isDataValid = !!id && !!name;\r\n    if (!isDataValid) {\r\n        return;\r\n    }\r\n    mappedTrack[id] = name;\r\n    var data = [\"mapTrack\", null, { id: id, name: name }];\r\n    trace({ data: data });\r\n};\r\nexports.mapTrack = mapTrack;\r\nvar connect = function () {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"connect error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    isManualConnect = true;\r\n    debugLog(\"info\", \"manual connect\");\r\n    maybeOpenWebsocketConnection({});\r\n};\r\nexports.connect = connect;\r\nvar disconnect = function () {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"disconnect error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    isManualConnect = false;\r\n    isManualDisconnect = true;\r\n    socket === null || socket === void 0 ? void 0 : socket.close();\r\n    debugLog(\"info\", \"manual disconnect\");\r\n};\r\nexports.disconnect = disconnect;\r\nvar registerOnStatsListener = function (listener) {\r\n    getStatsCallback = listener;\r\n};\r\nexports.registerOnStatsListener = registerOnStatsListener;\r\nvar registerStateListener = function (listener) {\r\n    stateListener = listener;\r\n};\r\nexports.registerStateListener = registerStateListener;\r\nvar httpTrace = function () {\r\n    var _a;\r\n    var data = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        data[_i] = arguments[_i];\r\n    }\r\n    if (!watchrtcIdentifiers.rtcRoomId || !watchrtcIdentifiers.rtcPeerId) {\r\n        var message = \"Cannot do http without room and peer ids\";\r\n        console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [message], false));\r\n        return Promise.reject(message);\r\n    }\r\n    if (!watchrtcIdentifiers.projectId && !watchrtcConfig.rtcApiKey) {\r\n        var message = \"Missing apiKey to enable trace before connection establishment\";\r\n        console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [message], false));\r\n        return Promise.reject(message);\r\n    }\r\n    var httpConnectionData = (0, utils_1.getConnectionData)(\"http\", watchrtcConfig.rtcApiKey, watchrtcConfig.proxyUrl);\r\n    return http\r\n        ? http.trace.apply(http, __spreadArray([\"\".concat(httpConnectionData.url, \"/trace\"), (_a = watchrtcIdentifiers.projectId) !== null && _a !== void 0 ? _a : httpConnectionData.key, watchrtcIdentifiers.rtcRoomId,\r\n            watchrtcIdentifiers.rtcPeerId], data, false)) : Promise.reject(\"Invalid configuration of http service\");\r\n};\r\nvar httpReportError = function (data) {\r\n    var apiKey = watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.rtcApiKey;\r\n    var rtcRoomId = watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.rtcRoomId;\r\n    var rtcPeerId = watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.rtcPeerId;\r\n    if (!apiKey || !rtcRoomId || !rtcPeerId) {\r\n        console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"Cannot report an error. Please provide apiKey, rtcRoomId and rtcPeerId \"], false));\r\n        return;\r\n    }\r\n    var httpConnectionData = (0, utils_1.getConnectionData)(\"http\", watchrtcConfig === null || watchrtcConfig === void 0 ? void 0 : watchrtcConfig.rtcApiKey, watchrtcConfig.proxyUrl);\r\n    data = data || (socket === null || socket === void 0 ? void 0 : socket.buffer) || [];\r\n    http === null || http === void 0 ? void 0 : http.trace(\"\".concat(httpConnectionData.url, \"/error\"), httpConnectionData.key, rtcRoomId, rtcPeerId, data);\r\n};\r\nvar persistentEnd = function (nailUpCallEnd) {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"persistentEnd error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    clearInterval(getStatsInterval);\r\n    isManualConnect = false;\r\n    isManualDisconnect = true;\r\n    socket === null || socket === void 0 ? void 0 : socket.close(nailUpCallEnd);\r\n    debugLog(\"info\", \"persistentEnd. sessionId: \".concat(window.watchRTCSessionId));\r\n};\r\nexports.persistentEnd = persistentEnd;\r\nvar resetConnectionState = function () {\r\n    var _a;\r\n    for (var _i = 0, _b = Object.values(openChannels); _i < _b.length; _i++) {\r\n        var channel = _b[_i];\r\n        channel.prev = null;\r\n    }\r\n    if ((_a = socket === null || socket === void 0 ? void 0 : socket.buffer) === null || _a === void 0 ? void 0 : _a.length) {\r\n        socket.buffer = [];\r\n    }\r\n};\r\nvar persistentStart = function (roomId, peerId) {\r\n    var initialized = window.watchRTCInitialized;\r\n    if (!initialized) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"persistentStart error. SDK is not initialized. Use 'init' function first.\"], false));\r\n        return;\r\n    }\r\n    watchrtcConfig = __assign(__assign({}, watchrtcConfig), { rtcRoomId: roomId, rtcPeerId: peerId });\r\n    watchrtcIdentifiers.rtcRoomId = roomId;\r\n    watchrtcIdentifiers.rtcPeerId = peerId;\r\n    resetConnectionState();\r\n    maybeOpenWebsocketConnection({});\r\n    debugLog(\"info\", \"persistentStart. sessionId: \".concat(window.watchRTCSessionId), { watchrtcConfig: watchrtcConfig });\r\n};\r\nexports.persistentStart = persistentStart;\r\n// (window as any).setUserRating = setUserRating;\r\n// (window as any).addTags = addTags;\r\n// (window as any).addKeys = addKeys;\r\n// (window as any).init = initSDK;\r\n// (window as any).addEvent = addEvent;\r\n// (window as any).wrtcConnect = connect;\r\n// (window as any).wrtcDisconnect = disconnect;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.getStreamsFromStats = exports.getTransportFromStats = void 0;\r\nvar getTransportFromStats = function (id, reports) {\r\n    if (!reports) {\r\n        return null;\r\n    }\r\n    var reportKeys = Object.keys(reports);\r\n    var keyPairs = reportKeys.filter(function (reportKey) { return reports[reportKey].type === \"candidate-pair\" && reports[reportKey].nominated; });\r\n    if (keyPairs.length > 0) {\r\n        var _a = reports[keyPairs[0]], localCandidateId_1 = _a.localCandidateId, remoteCandidateId_1 = _a.remoteCandidateId;\r\n        var localCandidateKey = reportKeys.find(function (reportKey) { return reports[reportKey].type === \"local-candidate\" && reports[reportKey].id === localCandidateId_1; });\r\n        var remoteCandidateKey = reportKeys.find(function (reportKey) { return reports[reportKey].type === \"remote-candidate\" && reports[reportKey].id === remoteCandidateId_1; });\r\n        if (localCandidateKey && remoteCandidateKey) {\r\n            var localCandidate = reports[localCandidateKey];\r\n            var remoteCandidate = reports[remoteCandidateKey];\r\n            var peer = {};\r\n            peer[id] = {\r\n                connection: localCandidate.candidateType === \"relay\" ? \"relay\" : \"direct\",\r\n                transport: localCandidate.candidateType === \"relay\" ? localCandidate.relayProtocol : \"udp\",\r\n                address: \"\".concat(remoteCandidate.address, \":\").concat(remoteCandidate.port),\r\n            };\r\n            return peer;\r\n        }\r\n    }\r\n    return null;\r\n};\r\nexports.getTransportFromStats = getTransportFromStats;\r\nvar getStreamsFromStats = function (id, previous, current, mappedTrack) {\r\n    var streams = {};\r\n    var currentReportsKeys = Object.keys(current);\r\n    var streamsKeys = currentReportsKeys.filter(function (keys) { return current[keys].type === \"inbound-rtp\" || current[keys].type === \"outbound-rtp\"; });\r\n    streamsKeys.forEach(function (streamKey) {\r\n        var currentReport = current[streamKey];\r\n        var previousReport = previous && streamKey in previous ? previous[streamKey] : null;\r\n        var direction = currentReport.type === \"inbound-rtp\" ? \"inbound\" : \"outbound\";\r\n        var kind = currentReport.kind;\r\n        var currentRemoteReport = currentReport.remoteId in current ? current[currentReport.remoteId] : null;\r\n        var previousRemoteReport = previousReport && previousReport.remoteId in previous ? previous[previousReport.remoteId] : null;\r\n        var deltaSeconds = previousReport ? (currentReport.timestamp - previousReport.timestamp) / 1000 : null;\r\n        var stream = {\r\n            direction: direction,\r\n            kind: kind,\r\n            peerId: id,\r\n        };\r\n        // Specific video (in inbound, outbound\r\n        if (kind === \"video\") {\r\n            stream.frameWidth = currentReport.frameWidth;\r\n            stream.frameHeight = currentReport.frameHeight;\r\n            stream.framerate = currentReport.framesPerSecond;\r\n        }\r\n        if (currentReport.type === \"inbound-rtp\") {\r\n            stream.jitter = currentReport.jitter;\r\n            // For inbound stream, trackIdentifier is part of the inbound-rtp report\r\n            stream.mappedName =\r\n                currentReport.trackIdentifier in mappedTrack ? mappedTrack[currentReport.trackIdentifier] : null;\r\n            // Compute intermediate values if previous report exists\r\n            stream.bytesReceived = previousReport ? currentReport.bytesReceived - previousReport.bytesReceived : null;\r\n            stream.packetsReceived = previousReport ? currentReport.packetsReceived - previousReport.packetsReceived : null;\r\n            stream.packetsLost = previousReport ? currentReport.packetsLost - previousReport.packetsLost : null;\r\n            stream.packetsLoss =\r\n                stream.packetsLost + stream.packetsReceived > 0\r\n                    ? (stream.packetsLost * 100) / (stream.packetsLost + stream.packetsReceived)\r\n                    : null;\r\n            stream.bitrate = deltaSeconds ? (stream.bytesReceived * 8) / deltaSeconds : null;\r\n            // Compute intermediate stats from remoteId (remoteOutbound);\r\n            stream.roundTripTime =\r\n                currentRemoteReport && \"roundTripTime\" in currentRemoteReport ? currentRemoteReport.roundTripTime : null;\r\n        }\r\n        else {\r\n            // Compute intermediate values if previous report exists\r\n            stream.bytesSent = previousReport ? currentReport.bytesSent - previousReport.bytesSent : null;\r\n            stream.packetsSent = previousReport ? currentReport.packetsSent - previousReport.packetsSent : null;\r\n            stream.bitrate = deltaSeconds ? (stream.bytesSent * 8) / deltaSeconds : null;\r\n            // Compute intermediate stats from remoteId (remoteInbound)\r\n            stream.roundTripTime =\r\n                currentRemoteReport && \"roundTripTime\" in currentRemoteReport ? currentRemoteReport.roundTripTime : null;\r\n            stream.jitter = currentRemoteReport && \"jitter\" in currentRemoteReport ? currentRemoteReport.jitter : null;\r\n            stream.packetsLost =\r\n                currentRemoteReport && previousRemoteReport\r\n                    ? currentRemoteReport.packetsLost - previousRemoteReport.packetsLost\r\n                    : null;\r\n            stream.packetsLoss =\r\n                currentRemoteReport && \"fractionLost\" in currentRemoteReport ? currentRemoteReport.fractionLost : null;\r\n            // For outbound stream, trackIdentifier is part of the media-source report\r\n            var mediaSourceKey = currentReportsKeys.find(function (key) { return current[key].id === currentReport.mediaSourceId; });\r\n            if (mediaSourceKey) {\r\n                var outboundTrackIdentifier = current[mediaSourceKey].trackIdentifier;\r\n                stream.mappedName = outboundTrackIdentifier in mappedTrack ? mappedTrack[outboundTrackIdentifier] : null;\r\n            }\r\n        }\r\n        streams[current[streamKey].id] = stream;\r\n    });\r\n    return streams;\r\n};\r\nexports.getStreamsFromStats = getStreamsFromStats;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.generateID = exports.applyPatchForRTT = exports.exposeApplicationStatsForPC = exports.restoreOriginalConsoleMethods = exports.setConsoleLevel = exports.getHardwareInfo = exports.validateEvent = exports.validateRating = exports.isRoomIdOrPeerIdChanged = exports.countOfValidConnections = exports.validateConfig = exports.getConnectionData = exports.dumpStream = exports.map2obj = exports.mangleChromeStats = exports.deltaCompression = exports.debugLog = exports.logPrefix = void 0;\r\nvar GPU = require(\"./detect-gpu\");\r\nvar stats_1 = require(\"./stats\");\r\nvar logPrefix = function (type) {\r\n    if (type === void 0) { type = \"info\"; }\r\n    return type === \"error\"\r\n        ? [\r\n            \"%cwatchRTC %cERROR\",\r\n            \"background: \".concat(\"gold\", \"; color: black; padding: 2px 0.5em; border-radius: 0.5em;\"),\r\n            \"background: \".concat(\"red\", \"; color: white; padding: 2px 0.5em; border-radius: 0.5em;\"),\r\n        ]\r\n        : [\"%cwatchRTC\", \"background: \".concat(\"gold\", \"; color: black; padding: 2px 0.5em; border-radius: 0.5em;\")];\r\n};\r\nexports.logPrefix = logPrefix;\r\nvar debugLog = function (getDebugStatus, prefix, message, object) {\r\n    var isDebugEnabled = getDebugStatus();\r\n    if (!isDebugEnabled) {\r\n        return;\r\n    }\r\n    var logArgs = __spreadArray(__spreadArray([], (0, exports.logPrefix)(prefix), true), [message], false);\r\n    if (object) {\r\n        logArgs.push(object);\r\n    }\r\n    console.log.apply(console, logArgs);\r\n};\r\nexports.debugLog = debugLog;\r\n// apply a delta compression to the stats report. Reduces size by ~90%.\r\n// To reduce further, report keys could be compressed.\r\n// Muly: maybe can improve using https://github.com/AsyncBanana/microdiff?utm_source=tldrnewsletter\r\nvar deltaCompression = function (oldStats, newStats) {\r\n    oldStats = oldStats || {};\r\n    newStats = newStats || {};\r\n    newStats = JSON.parse(JSON.stringify(newStats));\r\n    Object.keys(newStats).forEach(function (id) {\r\n        var report = newStats[id];\r\n        delete report.id;\r\n        if (!oldStats[id]) {\r\n            return;\r\n        }\r\n        Object.keys(report).forEach(function (name) {\r\n            if (report.timestamp && typeof report.timestamp === \"string\") {\r\n                report.timestamp = new Date(report.timestamp).getTime();\r\n            }\r\n            if (report[name] === oldStats[id][name]) {\r\n                delete newStats[id][name];\r\n            }\r\n            else if (Array.isArray(report[name])) {\r\n                // Arrays get serialized if anything changed.\r\n                if (JSON.stringify(report[name]) === JSON.stringify(oldStats[id][name])) {\r\n                    delete newStats[id][name];\r\n                }\r\n            }\r\n            if (Object.keys(report).length === 0) {\r\n                delete newStats[id];\r\n            }\r\n            else if (Object.keys(report).length === 1 && report.timestamp) {\r\n                delete newStats[id];\r\n            }\r\n        });\r\n    });\r\n    var timestamp = -Infinity;\r\n    Object.keys(newStats).forEach(function (id) {\r\n        var report = newStats[id];\r\n        if (report.timestamp > timestamp) {\r\n            timestamp = report.timestamp;\r\n        }\r\n    });\r\n    Object.keys(newStats).forEach(function (id) {\r\n        var report = newStats[id];\r\n        if (report.timestamp === timestamp) {\r\n            report.timestamp = 0;\r\n        }\r\n    });\r\n    newStats.timestamp = timestamp;\r\n    return newStats;\r\n};\r\nexports.deltaCompression = deltaCompression;\r\nvar mangleChromeStats = function (pc, response) {\r\n    var standardReport = {};\r\n    var reports = response.result();\r\n    reports.forEach(function (report) {\r\n        var standardStats = {\r\n            id: report.id,\r\n            timestamp: report.timestamp.getTime(),\r\n            type: report.type,\r\n        };\r\n        report.names().forEach(function (name) {\r\n            standardStats[name] = report.stat(name);\r\n        });\r\n        standardReport[standardStats.id] = standardStats;\r\n    });\r\n    return standardReport;\r\n};\r\nexports.mangleChromeStats = mangleChromeStats;\r\n// transforms a maplike to an object. Mostly for getStats +\r\n// JSON.parse(JSON.stringify())\r\nvar map2obj = function (m) {\r\n    if (!m.entries) {\r\n        return m;\r\n    }\r\n    var o = {};\r\n    m.forEach(function (v, k) {\r\n        o[k] = v;\r\n    });\r\n    return o;\r\n};\r\nexports.map2obj = map2obj;\r\nvar dumpStream = function (stream) {\r\n    return {\r\n        id: stream.id,\r\n        tracks: stream.getTracks().map(function (track) {\r\n            return {\r\n                id: track.id,\r\n                kind: track.kind,\r\n                label: track.label,\r\n                enabled: track.enabled,\r\n                muted: track.muted,\r\n                readyState: track.readyState, // `live` or `ended`\r\n            };\r\n        }),\r\n    };\r\n};\r\nexports.dumpStream = dumpStream;\r\nvar getConnectionData = function (type, key, proxyURL) {\r\n    var localUrl = \"\".concat(type == \"ws\" ? \"ws\" : \"http\", \"://localhost:9101\");\r\n    var staging1Url = \"\".concat(type == \"ws\" ? \"wss\" : \"https\", \"://watchrtc-staging1.testrtc.com\");\r\n    var staging2Url = \"\".concat(type == \"ws\" ? \"wss\" : \"https\", \"://watchrtc-staging2.testrtc.com\");\r\n    var productionUrl = \"\".concat(type == \"ws\" ? \"wss\" : \"https\", \"://watchrtc.testrtc.com\");\r\n    var production1Url = \"\".concat(type == \"ws\" ? \"wss\" : \"https\", \"://watchrtc-app1.testrtc.com\");\r\n    if (proxyURL && type === \"http\") {\r\n        if (proxyURL.includes(\"wss://\")) {\r\n            proxyURL = proxyURL.replace(\"wss://\", \"https://\");\r\n        }\r\n        else {\r\n            proxyURL = proxyURL.replace(\"ws://\", \"http://\");\r\n        }\r\n    }\r\n    var splitted = key.split(\":\");\r\n    if (key.indexOf(\"local\") !== -1) {\r\n        return {\r\n            url: proxyURL || localUrl,\r\n            key: splitted[1],\r\n        };\r\n    }\r\n    else if (key.indexOf(\"staging1\") !== -1) {\r\n        return {\r\n            url: proxyURL || staging1Url,\r\n            key: splitted[1],\r\n        };\r\n    }\r\n    else if (key.indexOf(\"staging\") !== -1) {\r\n        return {\r\n            url: proxyURL || staging2Url,\r\n            key: splitted[1],\r\n        };\r\n    }\r\n    else if (key.indexOf(\"production1\") !== -1) {\r\n        return {\r\n            url: proxyURL || production1Url,\r\n            key: splitted[1],\r\n        };\r\n    }\r\n    else if (key.indexOf(\"production\") !== -1) {\r\n        return {\r\n            url: proxyURL || productionUrl,\r\n            key: splitted[1],\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            url: proxyURL || productionUrl,\r\n            key: splitted[0],\r\n        };\r\n    }\r\n};\r\nexports.getConnectionData = getConnectionData;\r\nvar validateConfig = function (config) {\r\n    if (!(config === null || config === void 0 ? void 0 : config.rtcApiKey)) {\r\n        if (config === null || config === void 0 ? void 0 : config.debug) {\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"config.rtcApiKey or config.rtcToken need to be provided.\"], false));\r\n            return false;\r\n        }\r\n    }\r\n    if (!(config === null || config === void 0 ? void 0 : config.rtcRoomId) || !(config === null || config === void 0 ? void 0 : config.rtcPeerId)) {\r\n        if (config === null || config === void 0 ? void 0 : config.debug) {\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"info\"), false), [\"config.rtcRoomId or config.rtcPeerId is empty.\"], false));\r\n        }\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\nexports.validateConfig = validateConfig;\r\nvar countOfValidConnections = function (openChannels) {\r\n    return Object.keys(openChannels).filter(function (id) { return openChannels[id].validConnection; }).length;\r\n};\r\nexports.countOfValidConnections = countOfValidConnections;\r\nvar isRoomIdOrPeerIdChanged = function (watchrtcIdentifiers, watchrtcConfig) {\r\n    var changed = false;\r\n    if (watchrtcConfig.rtcRoomId &&\r\n        watchrtcIdentifiers.rtcRoomId &&\r\n        watchrtcIdentifiers.rtcRoomId !== watchrtcConfig.rtcRoomId) {\r\n        changed = true;\r\n    }\r\n    if (watchrtcConfig.rtcPeerId &&\r\n        watchrtcIdentifiers.rtcPeerId &&\r\n        watchrtcIdentifiers.rtcPeerId !== watchrtcConfig.rtcPeerId) {\r\n        changed = true;\r\n    }\r\n    if (changed && watchrtcConfig.debug) {\r\n        console.log.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"info\"), false), [\"maybeOpenWebsocketConnection. rtcRoomId or rtcPeerId has been changed\", {\r\n                old: {\r\n                    rtcRoomId: watchrtcIdentifiers.rtcRoomId,\r\n                    rtcPeerId: watchrtcIdentifiers.rtcPeerId,\r\n                },\r\n                new: {\r\n                    rtcRoomId: watchrtcConfig.rtcRoomId,\r\n                    rtcPeerId: watchrtcConfig.rtcPeerId,\r\n                },\r\n            }], false));\r\n    }\r\n    return changed;\r\n};\r\nexports.isRoomIdOrPeerIdChanged = isRoomIdOrPeerIdChanged;\r\nvar validateRating = function (rating) {\r\n    if (!rating) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"rating parameter is required\"], false));\r\n        return false;\r\n    }\r\n    if (typeof rating !== \"number\" || rating < 1 || rating > 5) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"rating parameter should be number from 1 to 5\"], false));\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\nexports.validateRating = validateRating;\r\nvar validateEvent = function (event) {\r\n    if (!event) {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"event parameter is required\"], false));\r\n        return false;\r\n    }\r\n    if (event.type !== \"global\" && event.type !== \"local\" && event.type !== \"log\") {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"event.type should be either \\\"global\\\" or \\\"local\\\" or \\\"log\\\"\"], false));\r\n        return false;\r\n    }\r\n    if (event.parameters && typeof event.parameters !== \"object\") {\r\n        console.info.apply(console, __spreadArray(__spreadArray([], (0, exports.logPrefix)(\"error\"), false), [\"event.parameters should be JSON object\\\"\"], false));\r\n        return false;\r\n    }\r\n    return true;\r\n};\r\nexports.validateEvent = validateEvent;\r\nvar getHardwareInfo = function () { return __awaiter(void 0, void 0, void 0, function () {\r\n    function number_format(num) {\r\n        return (Math.round(num * 100) / 100).toFixed(2);\r\n    }\r\n    var loadBenchmarks, gpuInfo, result, memory;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                loadBenchmarks = function (fileName) { return __awaiter(void 0, void 0, void 0, function () {\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0: return [4 /*yield*/, new Promise(function (resolve) {\r\n                                    try {\r\n                                        var data = require(\"./gpu-benchmarks/\".concat(fileName));\r\n                                        data.shift();\r\n                                        return resolve(data);\r\n                                    }\r\n                                    catch (err) {\r\n                                        console.error(\"Error. getHardwareInfo. loadBenchmarks\", { err: err.stack, fileName: fileName });\r\n                                        resolve([]);\r\n                                    }\r\n                                })];\r\n                            case 1: return [2 /*return*/, _a.sent()];\r\n                        }\r\n                    });\r\n                }); };\r\n                return [4 /*yield*/, GPU.getGPUTier({\r\n                        override: { loadBenchmarks: loadBenchmarks },\r\n                    })];\r\n            case 1:\r\n                gpuInfo = _a.sent();\r\n                result = __assign(__assign({}, gpuInfo), { cores_count: window.navigator.hardwareConcurrency });\r\n                memory = window.performance[\"memory\"];\r\n                if (memory) {\r\n                    result.jsHeapSizeLimit = number_format(memory.jsHeapSizeLimit / 1048576);\r\n                    result.totalJSHeapSize = number_format(memory.totalJSHeapSize / 1048576);\r\n                    result.usedJSHeapSize = number_format(memory.usedJSHeapSize / 1048576);\r\n                }\r\n                return [2 /*return*/, result];\r\n        }\r\n    });\r\n}); };\r\nexports.getHardwareInfo = getHardwareInfo;\r\nvar patchConsoleConfig = {\r\n    originalMethodPrefix: \"_original_\",\r\n    methodsToPatch: [\"log\", \"debug\", \"info\", \"warn\", \"error\"],\r\n    level: \"\",\r\n};\r\nvar patchConsoleMethod = function (methodName, trace) {\r\n    var originalMethod = console[methodName];\r\n    if (!originalMethod) {\r\n        return;\r\n    }\r\n    console[patchConsoleConfig.originalMethodPrefix + methodName] = originalMethod;\r\n    console[methodName] = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (patchConsoleConfig.level && args.length && trace) {\r\n            var currentMethodIndex = patchConsoleConfig.methodsToPatch.indexOf(methodName);\r\n            var configMethodIndex = patchConsoleConfig.methodsToPatch.indexOf(patchConsoleConfig.level);\r\n            var shouldTraceMethod = currentMethodIndex >= 0 && currentMethodIndex >= configMethodIndex;\r\n            if (shouldTraceMethod) {\r\n                var text = stringifyArgs(args);\r\n                trace({ data: [\"log\", null, { type: methodName, text: text }] });\r\n            }\r\n        }\r\n        originalMethod.apply(console, args);\r\n    };\r\n};\r\nvar setConsoleLevel = function (level, trace) {\r\n    if (level && patchConsoleConfig.methodsToPatch.includes(level) && level !== patchConsoleConfig.level) {\r\n        var currentIndex = patchConsoleConfig.methodsToPatch.indexOf(level);\r\n        var previousIndex = patchConsoleConfig.methodsToPatch.indexOf(patchConsoleConfig.level);\r\n        if (previousIndex < 0) {\r\n            for (var _i = 0, _a = patchConsoleConfig.methodsToPatch.slice(currentIndex); _i < _a.length; _i++) {\r\n                var methodName = _a[_i];\r\n                patchConsoleMethod(methodName, trace);\r\n            }\r\n        }\r\n        else if (currentIndex < previousIndex) {\r\n            for (var _b = 0, _c = patchConsoleConfig.methodsToPatch.slice(currentIndex, previousIndex); _b < _c.length; _b++) {\r\n                var methodName = _c[_b];\r\n                patchConsoleMethod(methodName, trace);\r\n            }\r\n        }\r\n        patchConsoleConfig.level = level;\r\n    }\r\n};\r\nexports.setConsoleLevel = setConsoleLevel;\r\nvar restoreOriginalConsoleMethods = function () {\r\n    if (!(\"console\" in window)) {\r\n        return;\r\n    }\r\n    for (var _i = 0, _a = patchConsoleConfig.methodsToPatch; _i < _a.length; _i++) {\r\n        var methodName = _a[_i];\r\n        var originalMethod = console[patchConsoleConfig.originalMethodPrefix + methodName];\r\n        if (!originalMethod) {\r\n            continue;\r\n        }\r\n        console[methodName] = originalMethod.bind(console);\r\n        delete console[patchConsoleConfig.originalMethodPrefix + methodName];\r\n    }\r\n};\r\nexports.restoreOriginalConsoleMethods = restoreOriginalConsoleMethods;\r\nvar exposeApplicationStatsForPC = function (id, previous, current, mappedTradk) {\r\n    return {\r\n        peer: (0, stats_1.getTransportFromStats)(id, current),\r\n        streams: (0, stats_1.getStreamsFromStats)(id, previous, current, mappedTradk),\r\n    };\r\n};\r\nexports.exposeApplicationStatsForPC = exposeApplicationStatsForPC;\r\nvar stringifyArgs = function (args) {\r\n    try {\r\n        return args.map(function (item) { return (typeof item === \"string\" ? item : JSON.stringify(item, replacerFunc())); }).join(\" \");\r\n    }\r\n    catch (_a) {\r\n        // do not log anything to not go into loop\r\n        // can fail with Illegal Invocation of JSON.stringify\r\n        // assumption - when customer also uses custom logger and binds another context\r\n        // so just ignore it\r\n        return \"\";\r\n    }\r\n};\r\n// avoid \"Converting circular structure to JSON\" error while JSON.stringifying\r\nvar replacerFunc = function () {\r\n    var visited = new WeakSet();\r\n    return function (_key, value) {\r\n        if (typeof value === \"object\" && value !== null) {\r\n            if (visited.has(value)) {\r\n                return;\r\n            }\r\n            visited.add(value);\r\n        }\r\n        return value;\r\n    };\r\n};\r\nvar applyPatchForRTT = function (oldStats, newStats) {\r\n    oldStats = oldStats || {};\r\n    newStats = newStats || {};\r\n    var hasOldStats = true;\r\n    if (Object.keys(oldStats).length === 0) {\r\n        hasOldStats = false;\r\n    }\r\n    var keys = Object.keys(newStats);\r\n    var reportKeys = keys.filter(function (key) { return newStats[key].type === \"remote-outbound-rtp\" || newStats[key].type === \"remote-inbound-rtp\"; });\r\n    reportKeys.forEach(function (reportKey) {\r\n        // case for Firefox/Safari\r\n        if (!(\"roundTripTime\" in newStats[reportKey])) {\r\n            newStats[reportKey].roundTripTime = NaN;\r\n        }\r\n        else {\r\n            // case Chrome\r\n            var statsHaveRTTMeasurements = \"roundTripTimeMeasurements\" in newStats[reportKey] &&\r\n                Boolean(oldStats[reportKey]) &&\r\n                \"roundTripTimeMeasurements\" in oldStats[reportKey];\r\n            if (hasOldStats && statsHaveRTTMeasurements) {\r\n                if (newStats[reportKey].roundTripTimeMeasurements === oldStats[reportKey].roundTripTimeMeasurements) {\r\n                    newStats[reportKey].roundTripTime = NaN;\r\n                }\r\n            }\r\n        }\r\n    });\r\n    return newStats;\r\n};\r\nexports.applyPatchForRTT = applyPatchForRTT;\r\nvar generateID = function () {\r\n    return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\r\n};\r\nexports.generateID = generateID;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = \"1.36.3\";\r\n","\"use strict\";\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar utils_1 = require(\"./utils\");\r\nvar WatchRTCHttp = /** @class */ (function () {\r\n    function WatchRTCHttp(options) {\r\n        this.debug = false;\r\n        if (WatchRTCHttp._instance) {\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"WatchRTCSocket instance already created\"], false));\r\n        }\r\n        else {\r\n            WatchRTCHttp._instance = this;\r\n            this.debug = !!options.debug;\r\n        }\r\n    }\r\n    WatchRTCHttp.prototype.trace = function (url, projectId, rtcRoomId, rtcPeerId) {\r\n        var data = [];\r\n        for (var _i = 4; _i < arguments.length; _i++) {\r\n            data[_i - 4] = arguments[_i];\r\n        }\r\n        var args = Array.prototype.slice.call(data);\r\n        args.push(Date.now());\r\n        if (args[1] instanceof RTCPeerConnection) {\r\n            args[1] = args[1].__rtcStatsId;\r\n        }\r\n        var response = fetch(url, {\r\n            method: \"POST\",\r\n            mode: \"cors\",\r\n            cache: \"no-cache\",\r\n            credentials: \"same-origin\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n                data: data,\r\n                projectId: projectId,\r\n                rtcRoomId: rtcRoomId,\r\n                rtcPeerId: rtcPeerId,\r\n            }),\r\n        });\r\n        return response\r\n            .then(function () { return ({}); })\r\n            .catch(function (err) {\r\n            console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [err.message, { err: err.stack }], false));\r\n            return { error: err };\r\n        });\r\n    };\r\n    return WatchRTCHttp;\r\n}());\r\nexports.default = WatchRTCHttp;\r\n","\"use strict\";\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar utils_1 = require(\"./utils\");\r\nvar LZString = require(\"./lz-string\");\r\nvar PROTOCOL_VERSION = \"2.0\";\r\nvar WatchRTCSocket = /** @class */ (function () {\r\n    function WatchRTCSocket(options) {\r\n        this.connection = null;\r\n        this.wasConnected = false;\r\n        this.buffer = [];\r\n        this.sendInterval = 1;\r\n        this.onClose = function () { };\r\n        this.debug = false;\r\n        this.dataCollection = true;\r\n        this.sendPromises = [];\r\n        this.trace = function (_a) {\r\n            var _b;\r\n            var data = _a.data, options = _a.options;\r\n            var args = Array.prototype.slice.call(data);\r\n            args.push(Date.now());\r\n            if (args[1] instanceof RTCPeerConnection) {\r\n                args[1] = args[1].__rtcStatsId;\r\n            }\r\n            if (!WatchRTCSocket._instance.dataCollection) {\r\n                if (options === null || options === void 0 ? void 0 : options.promiseFuncs) {\r\n                    options.promiseFuncs.resolve({ error: \"Data collection disabled\" });\r\n                }\r\n                return;\r\n            }\r\n            if (!WatchRTCSocket._instance.connection) {\r\n                if (WatchRTCSocket._instance.buffer.length > 1000) {\r\n                    if (options === null || options === void 0 ? void 0 : options.promiseFuncs) {\r\n                        options.promiseFuncs.resolve({ error: \"Message buffer size exceeded\" });\r\n                    }\r\n                    return;\r\n                }\r\n                WatchRTCSocket._instance.buffer.push(args);\r\n                if (options === null || options === void 0 ? void 0 : options.promiseFuncs) {\r\n                    WatchRTCSocket._instance.sendPromises.push(options.promiseFuncs);\r\n                }\r\n                return;\r\n            }\r\n            if (WatchRTCSocket._instance.connection.readyState === WebSocket.OPEN) {\r\n                WatchRTCSocket._instance.buffer.push(args);\r\n                if (options === null || options === void 0 ? void 0 : options.promiseFuncs) {\r\n                    WatchRTCSocket._instance.sendPromises.push(options.promiseFuncs);\r\n                }\r\n                if (WatchRTCSocket._instance.buffer.length >= WatchRTCSocket._instance.sendInterval) {\r\n                    var lines = JSON.stringify(WatchRTCSocket._instance.buffer);\r\n                    var compressedMessage = LZString.compressToEncodedURIComponent(lines);\r\n                    if (WatchRTCSocket._instance.debug) {\r\n                        var logFunc = (_b = console._original_log) !== null && _b !== void 0 ? _b : console.log;\r\n                        logFunc.apply(void 0, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"lines: \".concat(lines.length)], false));\r\n                        logFunc.apply(void 0, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"compressedMessage: \".concat(compressedMessage.length)], false));\r\n                    }\r\n                    WatchRTCSocket._instance.buffer = [];\r\n                    WatchRTCSocket._instance.connection.send(compressedMessage);\r\n                    WatchRTCSocket._instance.sendPromises.forEach(function (_a) {\r\n                        var resolve = _a.resolve;\r\n                        return resolve({});\r\n                    });\r\n                    WatchRTCSocket._instance.sendPromises = [];\r\n                }\r\n            }\r\n        };\r\n        if (WatchRTCSocket._instance) {\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"WatchRTCSocket instance already created\"], false));\r\n        }\r\n        else {\r\n            WatchRTCSocket._instance = this;\r\n            this.debug = !!options.debug;\r\n        }\r\n    }\r\n    WatchRTCSocket.prototype.connect = function (_a) {\r\n        var url = _a.url, onData = _a.onData, onError = _a.onError, onOpen = _a.onOpen, onClose = _a.onClose;\r\n        if (WatchRTCSocket._instance.connection) {\r\n            WatchRTCSocket._instance.connection.close();\r\n        }\r\n        var _this = WatchRTCSocket._instance;\r\n        WatchRTCSocket._instance.connection = new WebSocket(url, PROTOCOL_VERSION);\r\n        WatchRTCSocket._instance.connection.onopen = onOpen || null;\r\n        WatchRTCSocket._instance.connection.onclose = onClose || null;\r\n        WatchRTCSocket._instance.connection.onmessage = function (e) {\r\n            var _a;\r\n            try {\r\n                var data = JSON.parse(e.data);\r\n                if (data.error) {\r\n                    (_a = _this === null || _this === void 0 ? void 0 : _this.connection) === null || _a === void 0 ? void 0 : _a.close();\r\n                    _this.connection = null;\r\n                    console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"\\n\" + data.error], false));\r\n                    onError(data.error, \"auth\");\r\n                }\r\n                else {\r\n                    if (data.sendInterval) {\r\n                        WatchRTCSocket._instance.sendInterval = data.sendInterval;\r\n                    }\r\n                    onData(data);\r\n                    WatchRTCSocket._instance.wasConnected = true;\r\n                }\r\n            }\r\n            catch (err) {\r\n                console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [{ err: err.stack }], false));\r\n                onError(err.message);\r\n            }\r\n        };\r\n        WatchRTCSocket._instance.connection.onerror = function (e) {\r\n            console.info.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"error\"), false), [\"\\n\", e], false));\r\n            onError(e, \"connection\");\r\n        };\r\n    };\r\n    WatchRTCSocket.prototype.close = function (nailUpCallEnd) {\r\n        var _a, _b;\r\n        if (nailUpCallEnd && ((_b = (_a = WatchRTCSocket._instance) === null || _a === void 0 ? void 0 : _a.connection) === null || _b === void 0 ? void 0 : _b.readyState) === WebSocket.OPEN) {\r\n            var lines = JSON.stringify([\"nailUpCallEnd\", null, null]);\r\n            var compressedMessage = LZString.compressToEncodedURIComponent(lines);\r\n            WatchRTCSocket._instance.connection.send(compressedMessage);\r\n        }\r\n        WatchRTCSocket._instance.buffer = [];\r\n        WatchRTCSocket._instance.sendPromises.forEach(function (_a) {\r\n            var resolve = _a.resolve;\r\n            return resolve({ error: \"Connection was close\" });\r\n        });\r\n        WatchRTCSocket._instance.sendPromises = [];\r\n        if (WatchRTCSocket._instance.connection) {\r\n            WatchRTCSocket._instance.connection.close();\r\n            WatchRTCSocket._instance.onClose();\r\n            WatchRTCSocket._instance.connection = null;\r\n        }\r\n    };\r\n    WatchRTCSocket.prototype.disableDataCollection = function () {\r\n        if (WatchRTCSocket._instance.debug) {\r\n            console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"Data collection disabled.\"], false));\r\n        }\r\n        WatchRTCSocket._instance.dataCollection = false;\r\n    };\r\n    WatchRTCSocket.prototype.enableDataCollection = function () {\r\n        if (WatchRTCSocket._instance.debug) {\r\n            console.log.apply(console, __spreadArray(__spreadArray([], (0, utils_1.logPrefix)(\"info\"), false), [\"Data collection enabled.\"], false));\r\n        }\r\n        WatchRTCSocket._instance.dataCollection = true;\r\n    };\r\n    WatchRTCSocket.prototype.toggleDebug = function (debug) {\r\n        WatchRTCSocket._instance.debug = debug;\r\n    };\r\n    return WatchRTCSocket;\r\n}());\r\nexports.default = WatchRTCSocket;\r\n","!(function (e, r) {\n  \"object\" == typeof exports && \"undefined\" != typeof module\n    ? r(exports)\n    : \"function\" == typeof define && define.amd\n    ? define([\"exports\"], r)\n    : r(((e = \"undefined\" != typeof globalThis ? globalThis : e || self).DetectGPU = {}));\n})(this, function (e) {\n  \"use strict\";\n  var r = function (e, n) {\n    return (r =\n      Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array &&\n        function (e, r) {\n          e.__proto__ = r;\n        }) ||\n      function (e, r) {\n        for (var n in r) Object.prototype.hasOwnProperty.call(r, n) && (e[n] = r[n]);\n      })(e, n);\n  };\n  function n(e, r, n, t) {\n    return new (n || (n = Promise))(function (o, a) {\n      function i(e) {\n        try {\n          u(t.next(e));\n        } catch (e) {\n          a(e);\n        }\n      }\n      function c(e) {\n        try {\n          u(t.throw(e));\n        } catch (e) {\n          a(e);\n        }\n      }\n      function u(e) {\n        var r;\n        e.done\n          ? o(e.value)\n          : ((r = e.value),\n            r instanceof n\n              ? r\n              : new n(function (e) {\n                  e(r);\n                })).then(i, c);\n      }\n      u((t = t.apply(e, r || [])).next());\n    });\n  }\n  function t(e, r) {\n    var n,\n      t,\n      o,\n      a,\n      i = {\n        label: 0,\n        sent: function () {\n          if (1 & o[0]) throw o[1];\n          return o[1];\n        },\n        trys: [],\n        ops: [],\n      };\n    return (\n      (a = { next: c(0), throw: c(1), return: c(2) }),\n      \"function\" == typeof Symbol &&\n        (a[Symbol.iterator] = function () {\n          return this;\n        }),\n      a\n    );\n    function c(a) {\n      return function (c) {\n        return (function (a) {\n          if (n) throw new TypeError(\"Generator is already executing.\");\n          for (; i; )\n            try {\n              if (\n                ((n = 1),\n                t &&\n                  (o = 2 & a[0] ? t.return : a[0] ? t.throw || ((o = t.return) && o.call(t), 0) : t.next) &&\n                  !(o = o.call(t, a[1])).done)\n              )\n                return o;\n              switch (((t = 0), o && (a = [2 & a[0], o.value]), a[0])) {\n                case 0:\n                case 1:\n                  o = a;\n                  break;\n                case 4:\n                  return i.label++, { value: a[1], done: !1 };\n                case 5:\n                  i.label++, (t = a[1]), (a = [0]);\n                  continue;\n                case 7:\n                  (a = i.ops.pop()), i.trys.pop();\n                  continue;\n                default:\n                  if (!((o = i.trys), (o = o.length > 0 && o[o.length - 1]) || (6 !== a[0] && 2 !== a[0]))) {\n                    i = 0;\n                    continue;\n                  }\n                  if (3 === a[0] && (!o || (a[1] > o[0] && a[1] < o[3]))) {\n                    i.label = a[1];\n                    break;\n                  }\n                  if (6 === a[0] && i.label < o[1]) {\n                    (i.label = o[1]), (o = a);\n                    break;\n                  }\n                  if (o && i.label < o[2]) {\n                    (i.label = o[2]), i.ops.push(a);\n                    break;\n                  }\n                  o[2] && i.ops.pop(), i.trys.pop();\n                  continue;\n              }\n              a = r.call(e, i);\n            } catch (e) {\n              (a = [6, e]), (t = 0);\n            } finally {\n              n = o = 0;\n            }\n          if (5 & a[0]) throw a[1];\n          return { value: a[0] ? a[1] : void 0, done: !0 };\n        })([a, c]);\n      };\n    }\n  }\n  var o = [\n    \"geforce 320m\",\n    \"geforce 8600\",\n    \"geforce 8600m gt\",\n    \"geforce 8800 gs\",\n    \"geforce 8800 gt\",\n    \"geforce 9400\",\n    \"geforce 9400m g\",\n    \"geforce 9400m\",\n    \"geforce 9600m gt\",\n    \"geforce 9600m\",\n    \"geforce fx go5200\",\n    \"geforce gt 120\",\n    \"geforce gt 130\",\n    \"geforce gt 330m\",\n    \"geforce gtx 285\",\n    \"google swiftshader\",\n    \"intel g41\",\n    \"intel g45\",\n    \"intel gma 4500mhd\",\n    \"intel gma x3100\",\n    \"intel hd 3000\",\n    \"intel q45\",\n    \"legacy\",\n    \"mali-2\",\n    \"mali-3\",\n    \"mali-4\",\n    \"quadro fx 1500\",\n    \"quadro fx 4\",\n    \"quadro fx 5\",\n    \"radeon hd 2400\",\n    \"radeon hd 2600\",\n    \"radeon hd 4670\",\n    \"radeon hd 4850\",\n    \"radeon hd 4870\",\n    \"radeon hd 5670\",\n    \"radeon hd 5750\",\n    \"radeon hd 6290\",\n    \"radeon hd 6300\",\n    \"radeon hd 6310\",\n    \"radeon hd 6320\",\n    \"radeon hd 6490m\",\n    \"radeon hd 6630m\",\n    \"radeon hd 6750m\",\n    \"radeon hd 6770m\",\n    \"radeon hd 6970m\",\n    \"sgx 543\",\n    \"sgx543\",\n  ];\n  function a(e) {\n    return (e = e\n      .toLowerCase()\n      .replace(/^angle ?\\((.+)\\)*$/, \"$1\")\n      .replace(/\\s(\\d{1,2}gb|direct3d.+$)|\\(r\\)| \\([^)]+\\)$/g, \"\"));\n  }\n  const i = 34962;\n  var c = \"undefined\" == typeof window,\n    u = (function () {\n      if (!c) {\n        var e = window.navigator,\n          r = e.userAgent,\n          n = e.platform,\n          t = e.maxTouchPoints,\n          o = /(iphone|ipod|ipad)/i.test(r),\n          a = \"iPad\" === n || (\"MacIntel\" === n && t > 0 && !window.MSStream);\n        return { isIpad: a, isMobile: /android/i.test(r) || o || a, isSafari12: /Version\\/12.+Safari/.test(r) };\n      }\n    })();\n  function f(e, r, n) {\n    if (!n) return [r];\n    var t,\n      o = (function (e) {\n        var r =\n            \"\\n    precision highp float;\\n    attribute vec3 aPosition;\\n    varying float vvv;\\n    void main() {\\n      vvv = 0.31622776601683794;\\n      gl_Position = vec4(aPosition, 1.0);\\n    }\\n  \",\n          n =\n            \"\\n    precision highp float;\\n    varying float vvv;\\n    void main() {\\n      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\\n      enc = fract(enc);\\n      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\\n      gl_FragColor = enc;\\n    }\\n  \",\n          t = e.createShader(35633),\n          o = e.createShader(35632),\n          a = e.createProgram();\n        if (!(o && t && a)) return;\n        e.shaderSource(t, r),\n          e.shaderSource(o, n),\n          e.compileShader(t),\n          e.compileShader(o),\n          e.attachShader(a, t),\n          e.attachShader(a, o),\n          e.linkProgram(a),\n          e.detachShader(a, t),\n          e.detachShader(a, o),\n          e.deleteShader(t),\n          e.deleteShader(o),\n          e.useProgram(a);\n        var c = e.createBuffer();\n        e.bindBuffer(i, c), e.bufferData(i, new Float32Array([-1, -1, 0, 3, -1, 0, -1, 3, 0]), 35044);\n        var u = e.getAttribLocation(a, \"aPosition\");\n        e.vertexAttribPointer(u, 3, 5126, !1, 0, 0),\n          e.enableVertexAttribArray(u),\n          e.clearColor(1, 1, 1, 1),\n          e.clear(16384),\n          e.viewport(0, 0, 1, 1),\n          e.drawArrays(4, 0, 3);\n        var f = new Uint8Array(4);\n        return e.readPixels(0, 0, 1, 1, 6408, 5121, f), e.deleteProgram(a), e.deleteBuffer(c), f.join(\"\");\n      })(e),\n      a = \"801621810\",\n      c = \"8016218135\",\n      f = \"80162181161\",\n      l = (null == u ? void 0 : u.isIpad)\n        ? [\n            [\"a7\", f, 12],\n            [\"a8\", c, 15],\n            [\"a8x\", c, 15],\n            [\"a9\", c, 15],\n            [\"a9x\", c, 15],\n            [\"a10\", c, 15],\n            [\"a10x\", c, 15],\n            [\"a12\", a, 15],\n            [\"a12x\", a, 15],\n            [\"a12z\", a, 15],\n            [\"a14\", a, 15],\n            [\"m1\", a, 15],\n          ]\n        : [\n            [\"a7\", f, 12],\n            [\"a8\", c, 12],\n            [\"a9\", c, 15],\n            [\"a10\", c, 15],\n            [\"a11\", a, 15],\n            [\"a12\", a, 15],\n            [\"a13\", a, 15],\n            [\"a14\", a, 15],\n          ];\n    return (\n      \"80162181255\" === o\n        ? (t = l.filter(function (e) {\n            return e[2] >= 14;\n          }))\n        : (t = l.filter(function (e) {\n            return e[1] === o;\n          })).length || (t = l),\n      t.map(function (e) {\n        var r = e[0];\n        return \"apple \".concat(r, \" gpu\");\n      })\n    );\n  }\n  var l = [],\n    d = [];\n  function s(e, r) {\n    if (e === r) return 0;\n    var n = e;\n    e.length > r.length && ((e = r), (r = n));\n    for (var t = e.length, o = r.length; t > 0 && e.charCodeAt(~-t) === r.charCodeAt(~-o); ) t--, o--;\n    for (var a, i = 0; i < t && e.charCodeAt(i) === r.charCodeAt(i); ) i++;\n    if (((o -= i), 0 === (t -= i))) return o;\n    for (var c, u, f = 0, s = 0, h = 0; s < t; ) (d[s] = e.charCodeAt(i + s)), (l[s] = ++s);\n    for (; h < o; )\n      for (a = r.charCodeAt(i + h), c = h++, f = h, s = 0; s < t; s++)\n        (u = a === d[s] ? c : c + 1), (c = l[s]), (f = l[s] = c > f ? (u > f ? f + 1 : u) : u > c ? c + 1 : u);\n    return f;\n  }\n  function h(e) {\n    return null != e;\n  }\n  var v = (function (e) {\n    function n(r) {\n      var n = this.constructor,\n        t = e.call(this, r) || this;\n      return Object.setPrototypeOf(t, n.prototype), t;\n    }\n    return (\n      (function (e, n) {\n        if (\"function\" != typeof n && null !== n)\n          throw new TypeError(\"Class extends value \" + String(n) + \" is not a constructor or null\");\n        function t() {\n          this.constructor = e;\n        }\n        r(e, n), (e.prototype = null === n ? Object.create(n) : ((t.prototype = n.prototype), new t()));\n      })(n, e),\n      n\n    );\n  })(Error);\n  (e.getGPUTier = function (e) {\n    var r = void 0 === e ? {} : e,\n      i = r.mobileTiers,\n      l = void 0 === i ? [0, 15, 30, 60] : i,\n      d = r.desktopTiers,\n      p = void 0 === d ? [0, 15, 30, 60] : d,\n      g = r.override,\n      m = void 0 === g ? {} : g,\n      b = r.glContext,\n      w = r.failIfMajorPerformanceCaveat,\n      y = void 0 !== w && w,\n      x = r.benchmarksURL,\n      P = void 0 === x ? \"https://unpkg.com/detect-gpu@\".concat(\"4.0.8\", \"/dist/benchmarks\") : x;\n    return n(void 0, void 0, void 0, function () {\n      var e, r, i, d, g, w, x, A, S, _, C, E, L, M, j, B, k, O, T, U, I, D, R, G, N, K;\n      return t(this, function (W) {\n        switch (W.label) {\n          case 0:\n            if (((e = {}), c)) return [2, { tier: 0, type: \"SSR\" }];\n            if (\n              ((r = m.isIpad),\n              (i = void 0 === r ? !!(null == u ? void 0 : u.isIpad) : r),\n              (d = m.isMobile),\n              (g = void 0 === d ? !!(null == u ? void 0 : u.isMobile) : d),\n              (w = m.screenSize),\n              (x = void 0 === w ? window.screen : w),\n              (A = m.loadBenchmarks),\n              (S =\n                void 0 === A\n                  ? function (e) {\n                      return n(void 0, void 0, void 0, function () {\n                        var r;\n                        return t(this, function (n) {\n                          switch (n.label) {\n                            case 0:\n                              return [\n                                4,\n                                fetch(\"\".concat(P, \"/\").concat(e)).then(function (e) {\n                                  return e.json();\n                                }),\n                              ];\n                            case 1:\n                              if (((r = n.sent()), parseInt(r.shift().split(\".\")[0], 10) < 4))\n                                throw new v(\"Detect GPU benchmark data is out of date. Please update to version 4x\");\n                              return [2, r];\n                          }\n                        });\n                      });\n                    }\n                  : A),\n              (_ = m.renderer),\n              (C = function (e) {\n                for (\n                  var r = 0,\n                    n = g\n                      ? [\"adreno\", \"apple\", \"mali-t\", \"mali\", \"nvidia\", \"powervr\"]\n                      : [\"intel\", \"apple\", \"amd\", \"radeon\", \"nvidia\", \"geforce\"];\n                  r < n.length;\n                  r++\n                ) {\n                  var t = n[r];\n                  if (e.includes(t)) return t;\n                }\n              }),\n              (E = function (r) {\n                return n(void 0, void 0, void 0, function () {\n                  var n, o, a, c, u, f, l, d, h, p, m, b, w, y, P, A, _, E, L, M, j, B, k, O, T, U;\n                  return t(this, function (t) {\n                    switch (t.label) {\n                      case 0:\n                        if (!(n = C(r))) return [2];\n                        (o = \"\"\n                          .concat(g ? \"m\" : \"d\", \"-\")\n                          .concat(n)\n                          .concat(i ? \"-ipad\" : \"\", \".json\")),\n                          (a = e[o] = null !== (U = e[o]) && void 0 !== U ? U : S(o)),\n                          (t.label = 1);\n                      case 1:\n                        return t.trys.push([1, 3, , 4]), [4, a];\n                      case 2:\n                        return (c = t.sent()), [3, 4];\n                      case 3:\n                        if ((u = t.sent()) instanceof v) throw u;\n                        return [2];\n                      case 4:\n                        if (\n                          ((f = (function (e) {\n                            var r,\n                              n =\n                                (e = e.replace(/\\([^)]+\\)/, \"\")).match(/\\d+/) ||\n                                e.match(/(\\W|^)([A-Za-z]{1,3})(\\W|$)/g);\n                            return null !== (r = null == n ? void 0 : n.join(\"\").replace(/\\W|amd/g, \"\")) && void 0 !== r\n                              ? r\n                              : \"\";\n                          })(r)),\n                          (l = c.filter(function (e) {\n                            return e[1] === f;\n                          })).length ||\n                            (l = c.filter(function (e) {\n                              return e[0].includes(r);\n                            })),\n                          0 === (d = l.length))\n                        )\n                          return [2];\n                        for (\n                          h =\n                            d > 1\n                              ? l\n                                  .map(function (e) {\n                                    return [e, s(r, e[0])];\n                                  })\n                                  .sort(function (e, r) {\n                                    return e[1] - r[1];\n                                  })[0][0]\n                              : l[0],\n                            p = h[0],\n                            m = h[3],\n                            b = Number.MAX_VALUE,\n                            y = window.devicePixelRatio,\n                            P = x.width * y * x.height * y,\n                            A = 0,\n                            _ = m;\n                          A < _.length;\n                          A++\n                        )\n                          (E = _[A]),\n                            (L = E[0]),\n                            (M = E[1]),\n                            (j = L * M),\n                            (B = Math.abs(P - j)) < b && ((b = B), (w = E));\n                        return w ? ((O = (k = w)[2]), (T = k[3]), [2, [b, O, p, T]]) : [2];\n                    }\n                  });\n                });\n              }),\n              (L = function (e, r, n, t, o) {\n                return { device: o, fps: t, gpu: n, isMobile: g, tier: e, type: r };\n              }),\n              (j = \"\"),\n              _)\n            )\n              (_ = a(_)), (M = [_]);\n            else {\n              if (\n                !(B =\n                  b ||\n                  (function (e, r) {\n                    void 0 === r && (r = !1);\n                    var n = {\n                      alpha: !1,\n                      antialias: !1,\n                      depth: !1,\n                      failIfMajorPerformanceCaveat: r,\n                      powerPreference: \"high-performance\",\n                      stencil: !1,\n                    };\n                    e && delete n.powerPreference;\n                    var t = window.document.createElement(\"canvas\"),\n                      o = t.getContext(\"webgl\", n) || t.getContext(\"experimental-webgl\", n);\n                    return null != o ? o : void 0;\n                  })(null == u ? void 0 : u.isSafari12, y))\n              )\n                return [2, L(0, \"WEBGL_UNSUPPORTED\")];\n              if (\n                ((k = B.getExtension(\"WEBGL_debug_renderer_info\")) && (_ = B.getParameter(k.UNMASKED_RENDERER_WEBGL)),\n                !_)\n              )\n                return [2, L(1, \"FALLBACK\")];\n              (j = _),\n                (_ = a(_)),\n                (M = (function (e, r, n) {\n                  return \"apple gpu\" === r ? f(e, r, n) : [r];\n                })(B, _, g));\n            }\n            return [4, Promise.all(M.map(E))];\n          case 1:\n            if (\n              !(O = W.sent()\n                .filter(h)\n                .sort(function (e, r) {\n                  var n = e[0],\n                    t = void 0 === n ? Number.MAX_VALUE : n,\n                    o = e[1],\n                    a = r[0],\n                    i = void 0 === a ? Number.MAX_VALUE : a,\n                    c = r[1];\n                  return t === i ? o - c : t - i;\n                })).length\n            )\n              return [\n                2,\n                (T = o.find(function (e) {\n                  return _.includes(e);\n                }))\n                  ? L(0, \"BLOCKLISTED\", T)\n                  : L(1, \"FALLBACK\", \"\".concat(_, \" (\").concat(j, \")\")),\n              ];\n            if (((U = O[0]), (I = U[1]), (D = U[2]), (R = U[3]), -1 === I)) return [2, L(0, \"BLOCKLISTED\", D, I, R)];\n            for (G = g ? l : p, N = 0, K = 0; K < G.length; K++) I >= G[K] && (N = K);\n            return [2, L(N, \"BENCHMARK\", D, I, R)];\n        }\n      });\n    });\n  }),\n    Object.defineProperty(e, \"__esModule\", { value: !0 });\n});\n//# sourceMappingURL=detect-gpu.umd.js.map\n","var map = {\n\t\"./d-adreno.json\": 622,\n\t\"./d-amd.json\": 183,\n\t\"./d-apple.json\": 732,\n\t\"./d-geforce.json\": 405,\n\t\"./d-intel.json\": 178,\n\t\"./d-nvidia.json\": 217,\n\t\"./d-radeon.json\": 145,\n\t\"./m-adreno.json\": 921,\n\t\"./m-apple-ipad.json\": 535,\n\t\"./m-apple.json\": 438,\n\t\"./m-intel.json\": 283,\n\t\"./m-mali-t.json\": 327,\n\t\"./m-mali.json\": 538,\n\t\"./m-nvidia.json\": 884,\n\t\"./m-powervr.json\": 214\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 804;","var LZString = (function () {\n  function o(o, r) {\n    if (!t[o]) {\n      t[o] = {};\n      for (var n = 0; n < o.length; n++) t[o][o.charAt(n)] = n;\n    }\n    return t[o][r];\n  }\n  var r = String.fromCharCode,\n    n = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n    e = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$\",\n    t = {},\n    i = {\n      compressToBase64: function (o) {\n        if (null == o) return \"\";\n        var r = i._compress(o, 6, function (o) {\n          return n.charAt(o);\n        });\n        switch (r.length % 4) {\n          default:\n          case 0:\n            return r;\n          case 1:\n            return r + \"===\";\n          case 2:\n            return r + \"==\";\n          case 3:\n            return r + \"=\";\n        }\n      },\n      decompressFromBase64: function (r) {\n        return null == r\n          ? \"\"\n          : \"\" == r\n          ? null\n          : i._decompress(r.length, 32, function (e) {\n              return o(n, r.charAt(e));\n            });\n      },\n      compressToUTF16: function (o) {\n        return null == o\n          ? \"\"\n          : i._compress(o, 15, function (o) {\n              return r(o + 32);\n            }) + \" \";\n      },\n      decompressFromUTF16: function (o) {\n        return null == o\n          ? \"\"\n          : \"\" == o\n          ? null\n          : i._decompress(o.length, 16384, function (r) {\n              return o.charCodeAt(r) - 32;\n            });\n      },\n      compressToUint8Array: function (o) {\n        for (\n          var r = i.compress(o), n = new Uint8Array(2 * r.length), e = 0, t = r.length;\n          t > e;\n          e++\n        ) {\n          var s = r.charCodeAt(e);\n          (n[2 * e] = s >>> 8), (n[2 * e + 1] = s % 256);\n        }\n        return n;\n      },\n      decompressFromUint8Array: function (o) {\n        if (null === o || void 0 === o) return i.decompress(o);\n        for (var n = new Array(o.length / 2), e = 0, t = n.length; t > e; e++)\n          n[e] = 256 * o[2 * e] + o[2 * e + 1];\n        var s = [];\n        return (\n          n.forEach(function (o) {\n            s.push(r(o));\n          }),\n          i.decompress(s.join(\"\"))\n        );\n      },\n      compressToEncodedURIComponent: function (o) {\n        return null == o\n          ? \"\"\n          : i._compress(o, 6, function (o) {\n              return e.charAt(o);\n            });\n      },\n      decompressFromEncodedURIComponent: function (r) {\n        return null == r\n          ? \"\"\n          : \"\" == r\n          ? null\n          : ((r = r.replace(/ /g, \"+\")),\n            i._decompress(r.length, 32, function (n) {\n              return o(e, r.charAt(n));\n            }));\n      },\n      compress: function (o) {\n        return i._compress(o, 16, function (o) {\n          return r(o);\n        });\n      },\n      _compress: function (o, r, n) {\n        if (null == o) return \"\";\n        var e,\n          t,\n          i,\n          s = {},\n          p = {},\n          u = \"\",\n          c = \"\",\n          a = \"\",\n          l = 2,\n          f = 3,\n          h = 2,\n          d = [],\n          m = 0,\n          v = 0;\n        for (i = 0; i < o.length; i += 1)\n          if (\n            ((u = o.charAt(i)),\n            Object.prototype.hasOwnProperty.call(s, u) || ((s[u] = f++), (p[u] = !0)),\n            (c = a + u),\n            Object.prototype.hasOwnProperty.call(s, c))\n          )\n            a = c;\n          else {\n            if (Object.prototype.hasOwnProperty.call(p, a)) {\n              if (a.charCodeAt(0) < 256) {\n                for (e = 0; h > e; e++)\n                  (m <<= 1), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++;\n                for (t = a.charCodeAt(0), e = 0; 8 > e; e++)\n                  (m = (m << 1) | (1 & t)),\n                    v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                    (t >>= 1);\n              } else {\n                for (t = 1, e = 0; h > e; e++)\n                  (m = (m << 1) | t), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t = 0);\n                for (t = a.charCodeAt(0), e = 0; 16 > e; e++)\n                  (m = (m << 1) | (1 & t)),\n                    v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                    (t >>= 1);\n              }\n              l--, 0 == l && ((l = Math.pow(2, h)), h++), delete p[a];\n            } else\n              for (t = s[a], e = 0; h > e; e++)\n                (m = (m << 1) | (1 & t)),\n                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                  (t >>= 1);\n            l--, 0 == l && ((l = Math.pow(2, h)), h++), (s[c] = f++), (a = String(u));\n          }\n        if (\"\" !== a) {\n          if (Object.prototype.hasOwnProperty.call(p, a)) {\n            if (a.charCodeAt(0) < 256) {\n              for (e = 0; h > e; e++)\n                (m <<= 1), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++;\n              for (t = a.charCodeAt(0), e = 0; 8 > e; e++)\n                (m = (m << 1) | (1 & t)),\n                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                  (t >>= 1);\n            } else {\n              for (t = 1, e = 0; h > e; e++)\n                (m = (m << 1) | t), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t = 0);\n              for (t = a.charCodeAt(0), e = 0; 16 > e; e++)\n                (m = (m << 1) | (1 & t)),\n                  v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                  (t >>= 1);\n            }\n            l--, 0 == l && ((l = Math.pow(2, h)), h++), delete p[a];\n          } else\n            for (t = s[a], e = 0; h > e; e++)\n              (m = (m << 1) | (1 & t)),\n                v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++,\n                (t >>= 1);\n          l--, 0 == l && ((l = Math.pow(2, h)), h++);\n        }\n        for (t = 2, e = 0; h > e; e++)\n          (m = (m << 1) | (1 & t)), v == r - 1 ? ((v = 0), d.push(n(m)), (m = 0)) : v++, (t >>= 1);\n        for (;;) {\n          if (((m <<= 1), v == r - 1)) {\n            d.push(n(m));\n            break;\n          }\n          v++;\n        }\n        return d.join(\"\");\n      },\n      decompress: function (o) {\n        return null == o\n          ? \"\"\n          : \"\" == o\n          ? null\n          : i._decompress(o.length, 32768, function (r) {\n              return o.charCodeAt(r);\n            });\n      },\n      _decompress: function (o, n, e) {\n        var t,\n          i,\n          s,\n          p,\n          u,\n          c,\n          a,\n          l,\n          f = [],\n          h = 4,\n          d = 4,\n          m = 3,\n          v = \"\",\n          w = [],\n          A = { val: e(0), position: n, index: 1 };\n        for (i = 0; 3 > i; i += 1) f[i] = i;\n        for (p = 0, c = Math.pow(2, 2), a = 1; a != c; )\n          (u = A.val & A.position),\n            (A.position >>= 1),\n            0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n            (p |= (u > 0 ? 1 : 0) * a),\n            (a <<= 1);\n        switch ((t = p)) {\n          case 0:\n            for (p = 0, c = Math.pow(2, 8), a = 1; a != c; )\n              (u = A.val & A.position),\n                (A.position >>= 1),\n                0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n                (p |= (u > 0 ? 1 : 0) * a),\n                (a <<= 1);\n            l = r(p);\n            break;\n          case 1:\n            for (p = 0, c = Math.pow(2, 16), a = 1; a != c; )\n              (u = A.val & A.position),\n                (A.position >>= 1),\n                0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n                (p |= (u > 0 ? 1 : 0) * a),\n                (a <<= 1);\n            l = r(p);\n            break;\n          case 2:\n            return \"\";\n        }\n        for (f[3] = l, s = l, w.push(l); ; ) {\n          if (A.index > o) return \"\";\n          for (p = 0, c = Math.pow(2, m), a = 1; a != c; )\n            (u = A.val & A.position),\n              (A.position >>= 1),\n              0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n              (p |= (u > 0 ? 1 : 0) * a),\n              (a <<= 1);\n          switch ((l = p)) {\n            case 0:\n              for (p = 0, c = Math.pow(2, 8), a = 1; a != c; )\n                (u = A.val & A.position),\n                  (A.position >>= 1),\n                  0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n                  (p |= (u > 0 ? 1 : 0) * a),\n                  (a <<= 1);\n              (f[d++] = r(p)), (l = d - 1), h--;\n              break;\n            case 1:\n              for (p = 0, c = Math.pow(2, 16), a = 1; a != c; )\n                (u = A.val & A.position),\n                  (A.position >>= 1),\n                  0 == A.position && ((A.position = n), (A.val = e(A.index++))),\n                  (p |= (u > 0 ? 1 : 0) * a),\n                  (a <<= 1);\n              (f[d++] = r(p)), (l = d - 1), h--;\n              break;\n            case 2:\n              return w.join(\"\");\n          }\n          if ((0 == h && ((h = Math.pow(2, m)), m++), f[l])) v = f[l];\n          else {\n            if (l !== d) return null;\n            v = s + s.charAt(0);\n          }\n          w.push(v),\n            (f[d++] = s + v.charAt(0)),\n            h--,\n            (s = v),\n            0 == h && ((h = Math.pow(2, m)), m++);\n        }\n      },\n    };\n  return i;\n})();\n\"function\" == typeof define && define.amd\n  ? define(function () {\n      return LZString;\n    })\n  : \"undefined\" != typeof module && null != module && (module.exports = LZString);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(607);\n","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))"],"sourceRoot":""}